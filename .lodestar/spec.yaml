project:
  name: lodestar
  default_branch: main
  conventions:
    commit_style: conventional
    test_framework: pytest
tasks:
  F001:
    title: Initialize Typer CLI app with entry point
    description: M0 skeleton. Use Typer for CLI framework. Entry point is lodestar.
      Create src/lodestar/cli/ structure with app.py.
    acceptance_criteria:
    - lodestar command runs without error
    - lodestar --help displays available commands
    - --version flag works
    depends_on: []
    labels:
    - cli
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941178'
    updated_at: '2025-12-27T10:18:05.941184'
  F002:
    title: Implement lodestar init command
    description: M0 skeleton. Creates two-plane structure. spec.yaml has project name
      and empty tasks dict. AGENTS.md provides quick-start for agents.
    acceptance_criteria:
    - Creates .lodestar/spec.yaml with default structure
    - Creates .lodestar/.gitignore for runtime files
    - Creates root AGENTS.md with agent instructions
    - Command is idempotent - safe to run multiple times
    - Supports --json output
    depends_on: []
    labels:
    - cli
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941194'
    updated_at: '2025-12-27T10:18:05.941194'
  F003:
    title: Implement lodestar doctor command
    description: M0 skeleton. Health check command. Should detect common problems
      like missing files or corrupted database.
    acceptance_criteria:
    - Validates .lodestar directory exists
    - Validates spec.yaml is valid YAML and schema-conformant
    - Validates runtime.sqlite is accessible
    - Reports issues with suggested fixes
    - Supports --json output
    depends_on: []
    labels:
    - cli
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941200'
    updated_at: '2025-12-27T10:18:05.941200'
  F004:
    title: Implement lodestar status command
    description: M0 skeleton. Progressive discovery entry point. When run with no
      args lodestar should behave like status.
    acceptance_criteria:
    - Shows repo initialized status
    - Shows agent registration status
    - Shows task counts by status (ready/blocked/claimed/done/verified)
    - Shows active agent count
    - Suggests next actions (3-5 commands)
    - Supports --json output
    depends_on: []
    labels:
    - cli
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941205'
    updated_at: '2025-12-27T10:18:05.941205'
  F005:
    title: Implement spec plane with YAML schema
    description: M0 skeleton. Core spec plane. Use Pydantic v2 for models. spec.yaml
      is committed to git. Validate depends_on references exist.
    acceptance_criteria:
    - spec.yaml loads and validates against Pydantic schema
    - Project section with name and default_branch
    - Tasks dictionary with all required fields
    - Atomic file writes with portalocker
    - DAG cycle detection on save
    depends_on: []
    labels:
    - spec
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941209'
    updated_at: '2025-12-27T10:18:05.941209'
  F006:
    title: Implement runtime plane with SQLite WAL
    description: M0 skeleton. Core runtime plane. Use SQLite WAL for concurrent access.
      Tables agents/leases/messages/events(optional).
    acceptance_criteria:
    - runtime.sqlite created with WAL mode
    - agents table with schema from PRD
    - leases table with schema from PRD
    - messages table with schema from PRD
    - Database migrations framework
    - Gitignored automatically
    depends_on: []
    labels:
    - runtime
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941213'
    updated_at: '2025-12-27T10:18:05.941214'
  F007:
    title: Implement Pydantic models with JSON Schema export
    description: M0 skeleton. Models in src/lodestar/models/. Every command must support
      --schema to export its output schema.
    acceptance_criteria:
    - All spec models defined with Pydantic v2
    - All runtime models defined with Pydantic v2
    - JSON Schema export via --schema flag
    - Consistent JSON envelope structure (ok/data/next/warnings)
    depends_on: []
    labels:
    - models
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941218'
    updated_at: '2025-12-27T10:18:05.941218'
  F008:
    title: Implement --json and --explain flags for all commands
    description: M0 skeleton. Core CLI infrastructure. Use Rich for human output but
      disable for --json. --explain helps agents understand what commands do.
    acceptance_criteria:
    - All commands support --json flag
    - --json output uses consistent envelope structure
    - No ANSI codes in --json output
    - All commands support --explain flag
    - --explain returns agent-friendly command description
    depends_on: []
    labels:
    - cli
    - m0
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941224'
    updated_at: '2025-12-27T10:18:05.941225'
  F009:
    title: Implement lodestar agent join command
    description: M1 agent identity. Canonical entrypoint for agents. agent_id should
      be stable UUID. Store in runtime.sqlite agents table.
    acceptance_criteria:
    - Registers new agent with unique agent_id
    - Resumes existing agent if already registered
    - Returns agent_id in JSON response
    - Returns suggested next actions
    - Stores session_meta (tool name and model)
    - Supports --json output
    depends_on: []
    labels:
    - agent
    - m1
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941228'
    updated_at: '2025-12-27T10:18:05.941229'
  F010:
    title: Implement lodestar agent list command
    description: M1 agent identity. Show agents from runtime.sqlite. Active = last_seen_at
      within configurable window.
    acceptance_criteria:
    - Lists all registered agents
    - Shows agent_id and display_name and last_seen_at
    - Filters by active/inactive status
    - Supports --json output
    depends_on: []
    labels:
    - agent
    - m1
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941237'
    updated_at: '2025-12-27T10:18:05.941238'
  F011:
    title: Implement lodestar agent heartbeat command
    description: M1 agent identity. Updates agents.last_seen_at. Allows agents to
      signal they are still active.
    acceptance_criteria:
    - Updates last_seen_at for current agent
    - Returns time until next heartbeat needed
    - Can be called periodically by agent
    - Supports --json output
    depends_on: []
    labels:
    - agent
    - m1
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941241'
    updated_at: '2025-12-27T10:18:05.941242'
  F012:
    title: Implement lodestar agent brief command
    description: M1 agent identity. Used by orchestrator to spawn sub-agents. Brief
      should be self-contained context for task execution.
    acceptance_criteria:
    - Generates brief for specified task
    - Includes goal and acceptance criteria
    - Includes allowed paths/locks
    - Includes check commands
    - Supports --format flag (copilot/claude/generic)
    - Supports --json output
    depends_on: []
    labels:
    - agent
    - m1
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941246'
    updated_at: '2025-12-27T10:18:05.941246'
  F013:
    title: Implement lodestar task list command
    description: M2 tasks. Read from spec.yaml. Show which tasks are blocked vs ready.
      Cross-reference with runtime for claim status.
    acceptance_criteria:
    - Lists all tasks from spec.yaml
    - Shows task_id and title and status
    - Filters by status and labels
    - Shows dependency status
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941250'
    updated_at: '2025-12-27T10:18:05.941251'
  F014:
    title: Implement lodestar task show command
    description: M2 tasks. Merge spec and runtime data. Show which deps are satisfied
      vs pending.
    acceptance_criteria:
    - Shows full task details by ID
    - Shows all fields from spec
    - Shows current claim status from runtime
    - Shows dependency tree
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941254'
    updated_at: '2025-12-27T10:18:05.941255'
  F015:
    title: Implement lodestar task create command
    description: M2 tasks. Atomic write with portalocker. DAG validation is critical.
      Task IDs can be arbitrary strings or auto-generated.
    acceptance_criteria:
    - Creates new task in spec.yaml
    - Validates required fields
    - Validates depends_on references exist
    - Validates no DAG cycles created
    - Assigns unique task_id if not provided
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941258'
    updated_at: '2025-12-27T10:18:05.941259'
  F016:
    title: Implement lodestar task update command
    description: M2 tasks. Update any field except task_id. Re-validate DAG on dependency
      changes.
    acceptance_criteria:
    - Updates existing task fields
    - Validates field values
    - Validates no DAG cycles if depends_on changes
    - Atomic spec.yaml write
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941262'
    updated_at: '2025-12-27T10:18:05.941263'
  F017:
    title: Implement lodestar task next command
    description: M2 tasks. Core scheduling command. Must filter out expired leases.
      Include priority sorting.
    acceptance_criteria:
    - Returns only claimable tasks
    - Claimable = status ready AND all depends_on verified
    - Sorted by priority (lower number = higher priority)
    - Excludes tasks with active claims
    - Returns suggested claim command
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941266'
    updated_at: '2025-12-27T10:18:05.941267'
  F018:
    title: Implement lodestar task graph command
    description: M2 tasks. DAG visualization. Useful for external schedulers or debugging.
      Consider graphviz DOT format as --format dot.
    acceptance_criteria:
    - Exports task DAG as JSON
    - Optional DOT format output
    - Shows dependency relationships
    - Shows task statuses
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941270'
    updated_at: '2025-12-27T10:18:05.941271'
  F019:
    title: Implement DAG validation for task dependencies
    description: M2 tasks. Core spec validation. Use topological sort or DFS for cycle
      detection. Critical for task scheduling correctness.
    acceptance_criteria:
    - Detects cycles in depends_on graph
    - Validates all depends_on references exist
    - Runs on spec load and save
    - Returns clear error messages for violations
    - Prevents invalid spec from being saved
    depends_on: []
    labels:
    - spec
    - m2
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941276'
    updated_at: '2025-12-27T10:18:05.941276'
  F020:
    title: Implement lodestar task done command
    description: M2 tasks. Transition from claimed to done. Agent must hold the lease.
      Consider validation of acceptance criteria.
    acceptance_criteria:
    - Marks task status as done
    - Requires active claim by current agent
    - Releases the lease
    - Updates spec.yaml atomically
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941280'
    updated_at: '2025-12-27T10:18:05.941280'
  F021:
    title: Implement lodestar task verify command
    description: M2 tasks. Final task state. Verified tasks satisfy dependencies.
      May be done by different agent than implementer.
    acceptance_criteria:
    - Marks task status as verified
    - Verifies task was in done status
    - Updates spec.yaml atomically
    - Unlocks dependent tasks
    - Supports --json output
    depends_on: []
    labels:
    - task
    - m2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941284'
    updated_at: '2025-12-27T10:18:05.941284'
  F022:
    title: Implement lodestar task claim command
    description: M3 leases. Core claim logic. Use SQLite transaction for atomicity.
      Check task status=ready AND deps satisfied AND no active lease.
    acceptance_criteria:
    - Creates lease for task with TTL
    - Only succeeds if task is claimable
    - Only succeeds if no active lease exists
    - Atomic transaction prevents race conditions
    - Default TTL is 15 minutes
    - Supports --ttl flag for custom TTL
    - Supports --json output
    depends_on: []
    labels:
    - lease
    - m3
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941287'
    updated_at: '2025-12-27T10:18:05.941288'
  F023:
    title: Implement lodestar task renew command
    description: M3 leases. Keep lease alive while working. Default renewal extends
      by same TTL as original claim.
    acceptance_criteria:
    - Extends lease expires_at
    - Only current lease holder can renew
    - Returns new expiration time
    - Supports --ttl flag for renewal duration
    - Supports --json output
    depends_on: []
    labels:
    - lease
    - m3
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941293'
    updated_at: '2025-12-27T10:18:05.941293'
  F024:
    title: Implement lodestar task release command
    description: M3 leases. Abandon work without marking done. Useful when agent cannot
      complete the task.
    acceptance_criteria:
    - Releases lease without completing task
    - Only current lease holder can release
    - Task becomes claimable again
    - Supports --json output
    depends_on: []
    labels:
    - lease
    - m3
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941296'
    updated_at: '2025-12-27T10:18:05.941297'
  F025:
    title: Implement automatic lease expiry handling
    description: M3 leases. Core expiry behavior. All queries that check for active
      leases must filter by expires_at > now. No daemon needed.
    acceptance_criteria:
    - Expired leases filtered out at read time
    - No background daemon required
    - task next excludes expired claims
    - Expired tasks become claimable
    - Consistent expiry logic across all commands
    depends_on: []
    labels:
    - lease
    - m3
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941300'
    updated_at: '2025-12-27T10:18:05.941301'
  F026:
    title: Implement concurrent claim atomicity
    description: M3 leases. Critical correctness requirement. Use SQLite BEGIN IMMEDIATE
      or EXCLUSIVE transaction. Test with multiprocessing.
    acceptance_criteria:
    - Two simultaneous claims result in exactly one success
    - SQLite transaction isolation
    - No race conditions in claim logic
    - Concurrency test passes with multiple processes
    depends_on: []
    labels:
    - lease
    - m3
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:18:05.941304'
    updated_at: '2025-12-27T10:18:05.941305'
  F027:
    title: Implement lodestar msg send command
    description: M4 messaging. Store from_agent_id and to_type and to_id. Text in
      --text flag. Optional meta as JSON.
    acceptance_criteria:
    - Sends message to agent or task thread
    - Supports --to agent:A1 format
    - Supports --to task:T123 format
    - Stores in runtime.sqlite messages table
    - Returns message_id
    - Supports --json output
    depends_on: []
    labels:
    - messaging
    - m4
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941309'
    updated_at: '2025-12-27T10:18:05.941309'
  F028:
    title: Implement lodestar msg inbox command
    description: M4 messaging. Filter by to_type=agent and to_id=current_agent_id.
      Cursor can be message_id or timestamp.
    acceptance_criteria:
    - Lists messages sent to current agent
    - Supports --since cursor for pagination
    - Returns messages in chronological order
    - Returns cursor for next page
    - Supports --json output
    depends_on: []
    labels:
    - messaging
    - m4
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941313'
    updated_at: '2025-12-27T10:18:05.941313'
  F029:
    title: Implement lodestar msg thread command
    description: M4 messaging. Filter by to_type=task and to_id=task_id. Thread allows
      agents to discuss a specific task.
    acceptance_criteria:
    - Lists messages for a task thread
    - Supports --since cursor for pagination
    - Returns messages in chronological order
    - Returns cursor for next page
    - Supports --json output
    depends_on: []
    labels:
    - messaging
    - m4
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941317'
    updated_at: '2025-12-27T10:18:05.941317'
  F030:
    title: Implement lodestar mcp serve command
    description: M5 optional. MCP server for agents that prefer tool calls. Use mcp
      SDK. Each CLI command becomes an MCP tool.
    acceptance_criteria:
    - Starts MCP server on stdio or socket
    - Exposes all CLI operations as MCP tools
    - Tools mirror CLI command structure
    - Local-only authentication
    - Supports --json output
    depends_on: []
    labels:
    - mcp
    - m5
    locks: []
    priority: 3
    status: deleted
    created_at: '2025-12-27T10:18:05.941323'
    updated_at: '2025-12-27T16:06:04.033073'
  F031:
    title: Implement lodestar export snapshot command
    description: For CI systems and external dashboards. Combine spec.yaml data with
      runtime.sqlite data into single snapshot.
    acceptance_criteria:
    - Exports combined spec and runtime state
    - Includes all tasks with claim status
    - Includes all active agents
    - Includes message counts
    - JSON format output
    - Useful for CI and external tools
    depends_on: []
    labels:
    - cli
    - m2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:18:05.941328'
    updated_at: '2025-12-27T10:18:05.941329'
  TEST-001:
    title: Test task creation
    description: ''
    acceptance_criteria: []
    depends_on: []
    labels: []
    locks: []
    priority: 100
    status: verified
    created_at: '2025-12-27T10:18:05.941359'
    updated_at: '2025-12-27T10:18:13.535341'
  D001:
    title: Set up mkdocs with Material theme
    description: Initialize mkdocs project structure with Material theme. Create docs/
      directory, mkdocs.yml configuration, and basic navigation structure.
    acceptance_criteria: []
    depends_on: []
    labels:
    - docs
    - m6
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:25:16.712804'
    updated_at: '2025-12-27T10:36:58.624896'
  D002:
    title: Write getting started guide
    description: Document installation, quickstart, and first steps. Cover uv install,
      lodestar init, agent join, claiming first task.
    acceptance_criteria: []
    depends_on:
    - D001
    labels:
    - docs
    - m6
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T10:25:32.629762'
    updated_at: '2025-12-27T10:38:23.613196'
  D003:
    title: Document CLI command reference
    description: Auto-generate or manually document all CLI commands with examples.
      Use typer-cli or manual extraction. Include all flags and output examples.
    acceptance_criteria: []
    depends_on:
    - D001
    labels:
    - docs
    - m6
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:25:33.728180'
    updated_at: '2025-12-27T10:42:47.803255'
  D004:
    title: Document architecture and concepts
    description: Explain two-plane model, spec vs runtime, task lifecycle, lease mechanics,
      DAG scheduling. Include diagrams.
    acceptance_criteria: []
    depends_on:
    - D001
    labels:
    - docs
    - m6
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:25:34.890585'
    updated_at: '2025-12-27T10:45:30.251172'
  D005:
    title: Write agent workflow guide
    description: 'Document how agents should use lodestar: session start, claiming,
      working, completing, handoffs. Cover both human and AI agent workflows.'
    acceptance_criteria: []
    depends_on:
    - D002
    labels:
    - docs
    - m6
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T10:25:36.087490'
    updated_at: '2025-12-27T10:46:57.563052'
  D006:
    title: Set up docs build and deployment
    description: Configure GitHub Actions for mkdocs build. Set up GitHub Pages deployment.
      Add docs build to CI checks.
    acceptance_criteria: []
    depends_on:
    - D001
    labels:
    - docs
    - m6
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-27T10:25:37.271669'
    updated_at: '2025-12-27T10:48:37.109944'
  D007:
    title: Make README.md production ready for GitHub
    description: 'WHAT: Rewrite README.md to be a professional, production-ready landing
      page for the GitHub repository. Should attract users and clearly communicate
      value.


      WHERE: README.md (root)


      WHY: Current README is minimal placeholder. Need professional presence for public
      GitHub launch.


      ACCEPT:

      1) Has badges: PyPI version, CI status, docs link

      2) Clear value proposition explaining what Lodestar does and why

      3) Key features section highlighting: multi-agent coordination, lease-based
      claims, two-plane model, self-documenting CLI

      4) Installation section with uv and pip options

      5) Quick start that actually works (use ''uv run lodestar'' for dev)

      6) Link to full documentation (docs/ or GitHub Pages)

      7) Architecture overview mentioning spec.yaml vs runtime.sqlite

      8) Contributing section

      9) License section with link to LICENSE file


      CONTEXT:

      - See docs/index.md for landing page content to adapt

      - See docs/getting-started.md for installation/quickstart patterns

      - See docs/concepts/two-plane-model.md for architecture explanation

      - Package name is ''lodestar-cli'' on PyPI

      - CI is GitHub Actions (.github/workflows/)

      - Docs deploy to GitHub Pages'
    acceptance_criteria: []
    depends_on: []
    labels:
    - docs
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T13:15:53.183275'
    updated_at: '2025-12-27T13:22:58.344666'
  TEST-002:
    title: Implement webhook notification system
    description: Implement a webhook notification system based on the API design from
      TEST-001. Coordinate with the agent working on TEST-001 to clarify design decisions.
      Create a mock implementation with documentation.
    acceptance_criteria: []
    depends_on:
    - TEST-001
    labels:
    - feature
    locks: []
    priority: 2
    status: deleted
    created_at: '2025-12-27T14:48:37.441475'
    updated_at: '2025-12-27T19:39:12.745563'
  MSG-001:
    title: Fix or clarify task-scoped messaging
    description: 'PRIORITY: High. FROM: Agent communication test report (REPORT.md).
      ISSUE: ''lodestar msg thread task:<id>'' returns no messages even when agents
      discuss the task. Agents attempted ''--to task:<id>'' but messages didn''t appear
      in task threads. DECISION NEEDED: Either (1) fix task threading to work properly,
      or (2) remove the feature and document that direct agent-to-agent messaging
      is the primary pattern. ACCEPTANCE: Document the decision, update help text,
      ensure msg thread works or is removed, update docs/cli/msg.md with clarified
      usage patterns.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - messaging
    - m7
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T15:04:43.210080'
    updated_at: '2025-12-27T15:15:31.418218'
  MSG-002:
    title: Add message notification mechanism
    description: 'PRIORITY: High. FROM: Agent communication test report (REPORT.md).
      ISSUE: Agents poll ''lodestar msg inbox'' in loops with sleep delays, wasting
      cycles. SOLUTION: Add ''lodestar msg wait'' command that blocks until new message
      arrives. Also add message count to ''lodestar status'' output and ''--count''
      flag to ''msg inbox''. ACCEPTANCE: (1) Implement ''lodestar msg wait [--timeout
      SECONDS]'' that blocks on new messages, (2) Add message count to ''lodestar
      status'', (3) Add ''--count'' flag to ''msg inbox'', (4) Write tests for blocking
      behavior, (5) Update docs.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - messaging
    - m7
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T15:04:47.410231'
    updated_at: '2025-12-27T15:25:50.780781'
  AGT-001:
    title: Add agent metadata and discovery capabilities
    description: 'PRIORITY: High. FROM: Agent communication test report (REPORT.md).
      ISSUE: No way to discover what an agent specializes in. Agents can''t find the
      right collaborator easily. SOLUTION: (1) Add optional ''--role'' and ''--capabilities''
      fields to ''lodestar agent join'', (2) Store metadata in agents table, (3) Add
      ''lodestar agent find --capability <name>'' command, (4) Show metadata in ''lodestar
      agent list''. ACCEPTANCE: Extend agent join with optional metadata, implement
      agent find command, display metadata in agent list, update docs with examples
      of role/capability usage patterns.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - agent
    - m7
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T15:04:50.542272'
    updated_at: '2025-12-27T19:02:10.044313'
  MSG-003:
    title: Add message read status tracking
    description: 'PRIORITY: Medium. FROM: Agent communication test report (REPORT.md).
      ISSUE: No way for sender to know if recipient has read the message. SOLUTION:
      (1) Track when messages are retrieved by ''msg inbox'', (2) Add ''read_at''
      timestamp to messages table, (3) Add ''--show-read-status'' flag to ''msg inbox'',
      (4) Show read/unread indicator in inbox output. ACCEPTANCE: Database migration
      adds read_at field, inbox command updates read_at on retrieval, --show-read-status
      flag shows read timestamps, update JSON schema and docs.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - messaging
    - m7
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T15:04:53.836807'
    updated_at: '2025-12-27T15:27:13.777959'
  TSK-001:
    title: Enhance task status display with communication context
    description: 'PRIORITY: Medium. FROM: Agent communication test report (REPORT.md).
      ISSUE: When checking ''lodestar task show COMM-002'', there''s no indication
      of messages or agents working on related tasks. SOLUTION: (1) Show which agent
      is working on the task (from active lease), (2) Show message count related to
      task, (3) Display related agents who have sent messages about this task, (4)
      Add ''Related communications'' section to task show. ACCEPTANCE: task show includes
      current lease holder, message count, list of communicating agents, update docs
      with example output.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - task
    - m7
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T15:04:56.867433'
    updated_at: '2025-12-27T15:20:17.108116'
  DOC-001:
    title: Add agent coordination guide and templates
    description: 'PRIORITY: Medium. FROM: Agent communication test report (REPORT.md).
      NEED: Agents need guidance on coordination patterns. SOLUTION: Create docs/guides/agent-coordination.md
      with: (1) Example workflows for parallel agent work, (2) Message templates for
      common scenarios (requesting design, clarifying requirements, confirming completion),
      (3) Best practices for agent-to-agent communication, (4) Example multi-agent
      scenarios with full message flows. ACCEPTANCE: New guide created, covers discovery->communication->completion
      patterns, includes runnable examples, linked from main docs navigation.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - docs
    - m7
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T15:05:01.449174'
    updated_at: '2025-12-27T19:24:55.055430'
  MSG-004:
    title: Add message search and filtering
    description: 'PRIORITY: Low. FROM: Agent communication test report (REPORT.md).
      NEED: As agent conversations grow, finding specific messages becomes difficult.
      SOLUTION: (1) Add ''lodestar msg search --keyword <term>'' command, (2) Add
      ''--from <agent_id>'' filter to ''msg inbox'', (3) Add ''--since <date>'' and
      ''--until <date>'' filters, (4) Support combining filters. ACCEPTANCE: Implement
      msg search with keyword matching, add filtering options to inbox, support date
      range queries, update docs with search examples.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - messaging
    - m7
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-27T15:05:19.092843'
    updated_at: '2025-12-27T15:26:24.357336'
  AGT-002:
    title: Add agent availability status tracking
    description: 'PRIORITY: Low. FROM: Agent communication test report (REPORT.md).
      NEED: Know which agents are actively working vs idle. SOLUTION: (1) Add agent
      status field (active/idle/offline), (2) Auto-update status based on last activity,
      (3) Show status in ''agent list'', (4) Add configurable inactivity threshold.
      ACCEPTANCE: Extend agents table with status field, implement status calculation
      logic, display in agent list with color coding, make threshold configurable,
      update docs.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - agent
    - m7
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-27T15:05:21.889544'
    updated_at: '2025-12-27T19:35:19.412910'
  F032:
    title: Implement lodestar task delete command
    description: 'Add task deletion with soft-delete semantics:

      - Implement as state change (status=''deleted''), not physical removal

      - If task is depended on by other tasks, exit gracefully with notice listing
      dependents

      - If task has downstream dependencies (depends_on this task), cascade delete
      them

      - Hide deleted tasks from task list by default

      - Add --include-deleted flag to task list to show deleted tasks

      - Add --cascade flag to explicitly confirm cascade deletion

      - Update task show to indicate if task is deleted'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T15:46:04.462731'
    updated_at: '2025-12-27T15:55:00.110019'
  D010:
    title: Update CLI documentation for task delete command
    description: 'Update docs/cli/task.md to document:

      - lodestar task delete <id> command

      - --cascade flag behavior

      - Soft-delete semantics and how deleted tasks are hidden

      - --include-deleted flag on task list

      - Error messages when task has dependents

      - Examples of cascade deletion'
    acceptance_criteria: []
    depends_on:
    - F032
    labels:
    - docs
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T15:46:13.609680'
    updated_at: '2025-12-27T15:57:38.936251'
  D011:
    title: Update README for task delete feature
    description: 'Update README.md CLI reference section to include:

      - lodestar task delete command in quick reference

      - Brief description of soft-delete behavior

      - Update any task lifecycle mentions to include deletion'
    acceptance_criteria: []
    depends_on:
    - F032
    labels:
    - docs
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T15:46:21.334152'
    updated_at: '2025-12-27T15:58:37.530002'
  D012:
    title: Update CLAUDE.md CLI reference for task delete
    description: 'Update CLAUDE.md to include:

      - lodestar task delete command in CLI Command Reference section

      - Note about soft-delete behavior in Critical Patterns if relevant'
    acceptance_criteria: []
    depends_on:
    - F032
    labels:
    - docs
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T15:46:28.943346'
    updated_at: '2025-12-27T16:00:21.798330'
  TEST-DELETE-PARENT:
    title: Parent task for delete test
    description: ''
    acceptance_criteria: []
    depends_on: []
    labels: []
    locks: []
    priority: 100
    status: deleted
    created_at: '2025-12-27T16:06:28.579960'
    updated_at: '2025-12-27T16:06:44.562064'
  TEST-DELETE-CHILD1:
    title: Child 1 for delete test
    description: ''
    acceptance_criteria: []
    depends_on:
    - TEST-DELETE-PARENT
    labels: []
    locks: []
    priority: 100
    status: deleted
    created_at: '2025-12-27T16:06:29.740773'
    updated_at: '2025-12-27T16:06:44.562082'
  TEST-DELETE-CHILD2:
    title: Child 2 for delete test
    description: ''
    acceptance_criteria: []
    depends_on:
    - TEST-DELETE-PARENT
    labels: []
    locks: []
    priority: 100
    status: deleted
    created_at: '2025-12-27T16:06:31.371286'
    updated_at: '2025-12-27T16:06:44.562085'
  SQL-001:
    title: Add SQLAlchemy and Alembic dependencies
    description: Add sqlalchemy>=2.0.0 and alembic>=1.13.0 to pyproject.toml dependencies.
      Run 'uv sync' to install. Verify with 'python -c "import sqlalchemy; import
      alembic; print(sqlalchemy.__version__, alembic.__version__)"'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-27T19:52:56.855957'
    updated_at: '2025-12-27T19:55:50.055397'
  SQL-002:
    title: Create SQLAlchemy ORM models
    description: 'Create src/lodestar/runtime/models.py with SQLAlchemy ORM model
      definitions:


      1. Create Base class (DeclarativeBase)

      2. Create JSONField TypeDecorator for JSON storage in TEXT columns

      3. Create SchemaVersion model for version tracking

      4. Create AgentModel with fields: agent_id (PK), display_name, role, created_at,
      last_seen_at, capabilities (JSON list), session_meta (JSON dict)

      5. Create LeaseModel with fields: lease_id (PK), task_id, agent_id (FK), created_at,
      expires_at. Add indexes on task_id, agent_id, expires_at

      6. Create MessageModel with fields: message_id (PK), created_at, from_agent_id
      (FK), to_type, to_id, text, meta (JSON), read_at. Add composite index on (to_type,
      to_id) and indexes on from_agent_id, created_at

      7. Create EventModel with fields: event_id (autoincrement PK), created_at, event_type,
      agent_id, task_id, data (JSON). Add indexes on created_at, event_type


      Key design: Use String type for datetime fields (ISO format) to maintain compatibility
      with existing data patterns. Add relationships between models.'
    acceptance_criteria: []
    depends_on:
    - SQL-001
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T19:52:58.046756'
    updated_at: '2025-12-27T19:56:50.033310'
  SQL-003:
    title: Create engine and session factory module
    description: "Create src/lodestar/runtime/engine.py with SQLAlchemy engine and\
      \ session management:\n\n1. create_runtime_engine(db_path: Path) function:\n\
      \   - Create SQLAlchemy engine with sqlite:/// URL\n   - Disable connection\
      \ pooling (poolclass=None) for CLI tool\n   - Register event listener to enable\
      \ WAL mode on connect: PRAGMA journal_mode=WAL and PRAGMA busy_timeout=5000\n\
      \n2. create_session_factory(engine) function:\n   - Return sessionmaker bound\
      \ to engine with expire_on_commit=False\n\n3. get_session(session_factory) context\
      \ manager:\n   - Yield session\n   - Auto-commit on success\n   - Auto-rollback\
      \ on exception\n   - Always close session in finally block\n\nThis replicates\
      \ the transaction semantics of the current _connect() context manager."
    acceptance_criteria: []
    depends_on:
    - SQL-001
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T19:52:59.157273'
    updated_at: '2025-12-27T19:57:44.848911'
  SQL-004:
    title: Create Pydantic to SQLAlchemy converters
    description: "Create src/lodestar/runtime/converters.py with bidirectional conversion\
      \ functions between Pydantic models (in models/runtime.py) and SQLAlchemy ORM\
      \ models (in runtime/models.py):\n\n1. agent_to_orm(agent: Agent) -> AgentModel:\n\
      \   - Convert datetime fields to ISO format strings\n   - Pass capabilities\
      \ list and session_meta dict directly (JSONField handles serialization)\n\n\
      2. orm_to_agent(model: AgentModel) -> Agent:\n   - Convert ISO strings back\
      \ to datetime objects\n   - Handle backward compatibility: if capabilities is\
      \ not a list, default to empty list\n   - Default role to empty string if None\n\
      \n3. lease_to_orm(lease: Lease) -> LeaseModel:\n   - Convert datetime fields\
      \ to ISO format strings\n\n4. orm_to_lease(model: LeaseModel) -> Lease:\n  \
      \ - Convert ISO strings back to datetime objects\n\n5. message_to_orm(message:\
      \ Message) -> MessageModel:\n   - Convert to_type enum to string value\n   -\
      \ Convert read_at to ISO string or None\n\n6. orm_to_message(model: MessageModel)\
      \ -> Message:\n   - Convert to_type string to MessageType enum\n   - Handle\
      \ None read_at\n\nImport models from lodestar.models.runtime and lodestar.runtime.models."
    acceptance_criteria: []
    depends_on:
    - SQL-002
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-27T19:53:25.308714'
    updated_at: '2025-12-27T19:59:19.143725'
  SQL-005:
    title: Setup Alembic configuration and directory structure
    description: "Configure Alembic for database migrations:\n\n1. Create alembic.ini\
      \ in project root with:\n   - script_location = src/lodestar/runtime/alembic\n\
      \   - prepend_sys_path = src\n   - Default sqlalchemy.url = sqlite:///.lodestar/runtime.sqlite\n\
      \   - Standard logging configuration\n\n2. Create src/lodestar/runtime/alembic/\
      \ directory\n\n3. Create src/lodestar/runtime/alembic/env.py:\n   - Import Base.metadata\
      \ from lodestar.runtime.models\n   - get_url() function that checks LODESTAR_RUNTIME_DB_URL\
      \ env var, then falls back to find_lodestar_root()\n   - Standard run_migrations_offline()\
      \ and run_migrations_online() functions\n   - Use NullPool for online migrations\n\
      \n4. Create src/lodestar/runtime/alembic/script.py.mako with standard Alembic\
      \ template\n\n5. Create empty src/lodestar/runtime/alembic/versions/ directory\n\
      \nVerify with: uv run alembic --help (should show alembic commands)"
    acceptance_criteria: []
    depends_on:
    - SQL-002
    labels:
    - feature
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-27T19:53:26.532108'
    updated_at: '2025-12-27T20:00:27.657865'
  SQL-006:
    title: Create initial Alembic migration
    description: "Create the initial Alembic migration that creates the database schema:\n\
      \nCreate src/lodestar/runtime/alembic/versions/001_initial_schema.py:\n\n1.\
      \ Set revision = '001', down_revision = None\n\n2. upgrade() function creates\
      \ all tables:\n   - schema_version: version (INTEGER PK)\n   - agents: agent_id\
      \ (PK), display_name, role, created_at, last_seen_at, capabilities (TEXT JSON),\
      \ session_meta (TEXT JSON)\n   - leases: lease_id (PK), task_id, agent_id (FK\
      \ to agents), created_at, expires_at + indexes on task_id, agent_id, expires_at\n\
      \   - messages: message_id (PK), created_at, from_agent_id (FK), to_type, to_id,\
      \ text, meta (TEXT JSON), read_at + composite index on (to_type, to_id), indexes\
      \ on from_agent_id, created_at\n   - events: event_id (INTEGER AUTOINCREMENT\
      \ PK), created_at, event_type, agent_id, task_id, data (TEXT JSON) + indexes\
      \ on created_at, event_type\n\n3. downgrade() function drops all tables in reverse\
      \ order\n\nTest: Create a temp database and verify 'uv run alembic upgrade head'\
      \ creates all tables with correct schema."
    acceptance_criteria: []
    depends_on:
    - SQL-005
    labels:
    - feature
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-27T19:53:27.695108'
    updated_at: '2025-12-27T20:01:32.012543'
  SQL-007:
    title: Refactor RuntimeDatabase to use SQLAlchemy
    description: 'Refactor src/lodestar/runtime/database.py to use SQLAlchemy ORM
      instead of raw sqlite3:


      CRITICAL: Keep the same public interface - all method signatures must remain
      unchanged so CLI commands don''t need modification.


      Key changes:

      1. __init__(): Create engine and session_factory instead of storing db_path
      only

      2. Replace _connect() usage with get_session(self._session_factory)

      3. _ensure_initialized(): Use Base.metadata.create_all(self._engine) instead
      of manual CREATE TABLE


      Agent operations (refactor all):

      - register_agent(): Use session.add(agent_to_orm(agent))

      - get_agent(): Use select(AgentModel).where(...), return orm_to_agent()

      - list_agents(): Use select(AgentModel).order_by(), convert all results

      - find_agents_by_capability(): Use raw SQL with text() for json_each() SQLite
      function

      - find_agents_by_role(): Use select().where(AgentModel.role == role)

      - update_heartbeat(): Use session.execute(update(AgentModel).where(...).values(...))


      Lease operations (CRITICAL - maintain atomicity):

      - create_lease(): Within single session, check for existing active lease, then
      insert. Must remain atomic to prevent race conditions.

      - get_active_lease(): Filter by expires_at > now.isoformat()

      - get_agent_leases(): Filter by agent_id

      - renew_lease(): Update expires_at

      - release_lease(): Set expires_at to now


      Message operations (refactor all):

      - send_message(), get_inbox(), get_task_thread(), get_task_message_count(),
      get_task_message_agents(), search_messages(), get_inbox_count(), wait_for_message()


      Stats operations:

      - get_stats(): Use func.count() aggregations

      - get_agent_message_counts(): Use GROUP BY with func.count()


      Internal:

      - _log_event(): Accept session as first parameter to work within existing transaction

      - Remove _create_schema(), _run_migrations(), SCHEMA_VERSION constant (Alembic
      handles this now)


      Test incrementally: Run ''uv run pytest tests/test_runtime.py'' frequently during
      refactor.'
    acceptance_criteria: []
    depends_on:
    - SQL-003
    - SQL-004
    - SQL-006
    labels:
    - feature
    locks: []
    priority: 4
    status: verified
    created_at: '2025-12-27T19:54:08.070867'
    updated_at: '2025-12-27T20:05:16.418368'
  SQL-008:
    title: Update runtime tests for SQLAlchemy
    description: "Update tests/test_runtime.py to work with the new SQLAlchemy-based\
      \ RuntimeDatabase:\n\n1. Most tests should pass without changes since the public\
      \ interface is unchanged\n\n2. Update test_expired_lease_not_active (or similar\
      \ tests that access db._connect()):\n   - Replace: with db._connect() as conn:\
      \ conn.execute(...)\n   - With: from lodestar.runtime.engine import get_session;\
      \ from lodestar.runtime.converters import lease_to_orm; with get_session(db._session_factory)\
      \ as session: session.add(lease_to_orm(lease))\n\n3. Add new tests for SQLAlchemy-specific\
      \ functionality:\n   - Test WAL mode is enabled: Execute 'PRAGMA journal_mode'\
      \ and verify returns 'wal'\n   - Test session rollback on exception\n   - Test\
      \ JSONField serialization/deserialization edge cases (empty list, None handling)\n\
      \n4. Run full test suite: uv run pytest tests/test_runtime.py -v\n\n5. Ensure\
      \ all 40+ existing tests pass"
    acceptance_criteria: []
    depends_on:
    - SQL-007
    labels:
    - test
    locks: []
    priority: 5
    status: verified
    created_at: '2025-12-27T19:54:09.237030'
    updated_at: '2025-12-27T20:05:30.533008'
  SQL-009:
    title: End-to-end verification and cleanup
    description: "Final verification and cleanup after SQLAlchemy migration:\n\n1.\
      \ Delete existing .lodestar/runtime.sqlite if present (clean migration)\n\n\
      2. Run full test suite:\n   - uv run pytest (all tests should pass)\n   - uv\
      \ run ruff check src tests\n   - uv run ruff format --check src tests\n\n3.\
      \ Test CLI commands manually:\n   - uv run lodestar init (in temp directory)\n\
      \   - uv run lodestar agent join\n   - uv run lodestar task create --title 'Test\
      \ task'\n   - uv run lodestar task claim <id>\n   - uv run lodestar task release\
      \ <id>\n   - uv run lodestar msg send --to agent:<id> --text 'Test'\n   - uv\
      \ run lodestar status\n\n4. Verify Alembic autogenerate detects no drift:\n\
      \   - uv run alembic revision --autogenerate -m 'check' (should show 'No changes')\n\
      \   - Delete the generated empty migration\n\n5. Update runtime/__init__.py\
      \ if additional exports needed\n\n6. Optional: Add 'alembic' to .gitignore if\
      \ it creates any cache files\n\n7. Update documentation if runtime internals\
      \ are mentioned anywhere\n\nCommit message: 'feat: Migrate runtime database\
      \ to SQLAlchemy ORM with Alembic migrations'"
    acceptance_criteria: []
    depends_on:
    - SQL-008
    labels:
    - test
    locks: []
    priority: 6
    status: verified
    created_at: '2025-12-27T19:54:10.431185'
    updated_at: '2025-12-27T20:08:07.952636'
  D020:
    title: Document PRD context feature in task.md
    description: "WHAT: Document the new PRD context feature in the CLI task reference.\n\
      WHERE: docs/cli/task.md\nWHY: PRD_REFS.md feature is implemented but not documented\
      \ - agents need to know how to use prd_refs, prd_excerpt, and prd_hash on tasks.\n\
      \nACCEPT:\n1) Add 'task context' command section with full documentation\n2)\
      \ Update 'task create' section to show --prd-source, --prd-ref, --prd-excerpt\
      \ options  \n3) Update 'task claim' section to document context bundle and --no-context\
      \ flag\n4) Include examples of creating tasks with PRD context attached\n5)\
      \ Explain drift detection warnings\n\nCONTEXT:\n- See src/lodestar/models/spec.py\
      \ for PrdContext and PrdRef models\n- See src/lodestar/cli/commands/task.py\
      \ for task_context and task_claim implementations\n- See src/lodestar/util/prd.py\
      \ for hash and extraction utilities\n- PRD_REFS.md explains the motivation for\
      \ this feature"
    acceptance_criteria: []
    depends_on: []
    labels:
    - docs
    - prd-context
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T01:05:42.370433+00:00'
    updated_at: '2025-12-28T01:11:54.496369+00:00'
  D021:
    title: Document PRD context concepts
    description: "WHAT: Add new concepts documentation explaining PRD context integration.\n\
      WHERE: docs/concepts/ (new file: prd-context.md)\nWHY: PRD_REFS.md describes\
      \ a major feature - 'PRD section pointers + context delivery' - that needs conceptual\
      \ documentation for users to understand WHY this exists and HOW it works.\n\n\
      ACCEPT:\n1) Create docs/concepts/prd-context.md with:\n   - Overview: PRD =\
      \ encyclopedia, task = mission card\n   - prd_refs field explanation (anchors,\
      \ line ranges)\n   - prd_excerpt frozen snapshot concept\n   - prd_hash drift\
      \ detection mechanism\n2) Update docs/concepts/index.md to link to new page\n\
      3) Explain the claim-time context delivery workflow\n4) Include diagrams/examples\
      \ showing task creation with PRD context\n\nCONTEXT:\n- PRD_REFS.md section\
      \ 'A concrete shape that combines the strongest ideas' is the design doc\n-\
      \ src/lodestar/models/spec.py has PrdContext and PrdRef models  \n- Feature\
      \ solves: 'future sessions never need the PRD at all for most tasks'"
    acceptance_criteria: []
    depends_on:
    - D020
    labels:
    - docs
    - prd-context
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T01:06:00.114359+00:00'
    updated_at: '2025-12-28T01:19:11.418461+00:00'
  D022:
    title: Update README.md with PRD context feature
    description: 'WHAT: Add PRD context feature to README.md Quick Start and Key Features.

      WHERE: README.md

      WHY: README is the first thing users see - it should mention this major differentiating
      feature.


      ACCEPT:

      1) Add ''PRD Context Delivery'' to Key Features list with brief description

      2) Update Quick Start to show creating a task WITH prd context (optional advanced
      example)

      3) Add example of ''lodestar task context <id>'' in How It Works section

      4) Mention drift detection as a feature


      CONTEXT:

      - Current README has no mention of PRD context features

      - Keep changes minimal - README should stay concise

      - Focus on: what the feature does, one-line CLI example

      - See PRD_REFS.md for feature motivation'
    acceptance_criteria: []
    depends_on:
    - D020
    labels:
    - docs
    - prd-context
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T01:06:10.692893+00:00'
    updated_at: '2025-12-28T01:19:12.330430+00:00'
  D023:
    title: Update agent-workflow guide for PRD context
    description: "WHAT: Update agent workflow guide to incorporate PRD context best\
      \ practices.\nWHERE: docs/guides/agent-workflow.md\nWHY: Agents need guidance\
      \ on how to leverage PRD context when claiming and working on tasks.\n\nACCEPT:\n\
      1) Add section: 'Understanding Task Context' explaining prd_refs/excerpt\n2)\
      \ Update 'Claiming a Task' section to mention context bundle delivery\n3) Add\
      \ best practice: 'Always check for PRD drift warnings'\n4) Show example workflow:\
      \ claim task -> review context -> work -> done\n5) Add tip about using 'task\
      \ context' to get full PRD snippets\n\nCONTEXT:\n- docs/guides/agent-workflow.md\
      \ exists but doesn't mention PRD context\n- task claim now automatically includes\
      \ context (unless --no-context)\n- This is key for planning\u2192executing agent\
      \ handoffs"
    acceptance_criteria: []
    depends_on:
    - D021
    labels:
    - docs
    - prd-context
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T01:06:22.321870+00:00'
    updated_at: '2025-12-28T01:20:17.642496+00:00'
  D024:
    title: Update docs/index.md with PRD context overview
    description: 'WHAT: Update the docs landing page to mention PRD context feature.

      WHERE: docs/index.md

      WHY: The docs landing page lists features but is missing this key capability.


      ACCEPT:

      1) Add ''PRD Context Delivery'' to Features list

      2) Update Quick Start section if it references task claiming

      3) Ensure consistency with README.md feature list


      CONTEXT:

      - Current docs/index.md has minimal content

      - Keep changes proportional to existing content

      - Link to concepts/prd-context.md if it exists'
    acceptance_criteria: []
    depends_on:
    - D021
    labels:
    - docs
    - prd-context
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T01:06:32.734638+00:00'
    updated_at: '2025-12-28T01:20:18.468885+00:00'
  D025:
    title: Update getting-started.md with task context example
    description: "WHAT: Add PRD context examples to getting started guide.\nWHERE:\
      \ docs/getting-started.md\nWHY: New users should see the task context workflow\
      \ early.\n\nACCEPT:\n1) Add optional 'Advanced: Creating Tasks with PRD Context'\
      \ section\n2) Show example of 'lodestar task context <id>'  \n3) Explain when/why\
      \ to use PRD context (planning agent \u2192 executing agent handoff)\n4) Keep\
      \ core quick start flow unchanged (don't bloat the happy path)\n\nCONTEXT:\n\
      - getting-started.md is for first-time users\n- PRD context is optional - don't\
      \ make it required to understand\n- Place advanced content at end or in collapsible\
      \ section"
    acceptance_criteria: []
    depends_on:
    - D020
    labels:
    - docs
    - prd-context
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T01:06:46.575592+00:00'
    updated_at: '2025-12-28T01:19:13.144378+00:00'
  D026:
    title: Add PRD context reference schema documentation
    description: "WHAT: Document the PrdContext and PrdRef schema in reference docs.\n\
      WHERE: docs/reference/index.md (or new docs/reference/schemas.md)\nWHY: Programmatic\
      \ users need schema reference for spec.yaml prd fields.\n\nACCEPT:\n1) Document\
      \ PrdContext fields: source, refs, excerpt, prd_hash\n2) Document PrdRef fields:\
      \ anchor, lines  \n3) Show example spec.yaml task with full prd context\n4)\
      \ Document JSON output format from 'task context --json'\n5) Include schema\
      \ export example using --schema flag\n\nCONTEXT:\n- Reference docs should be\
      \ complete and precise\n- See src/lodestar/models/spec.py for canonical schema\n\
      - PRD_REFS.md 'Example (illustrative YAML)' section shows target format"
    acceptance_criteria: []
    depends_on:
    - D021
    labels:
    - docs
    - prd-context
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T01:06:57.736880+00:00'
    updated_at: '2025-12-28T01:20:19.248872+00:00'
  H001:
    title: Add --explain with examples to 9 commands
    description: 'WHAT: Add --explain flag with usage examples to 9 commands that
      currently lack it: task create, task update, task renew, task release, task
      done, task verify, task delete, task graph (in task.py), and agent heartbeat
      (in agent.py).


      WHERE: src/lodestar/cli/commands/task.py, src/lodestar/cli/commands/agent.py


      WHY: PRD requires all commands support --explain for progressive discovery.
      Currently 9 commands are missing this flag, making it harder for agents to understand
      command purpose and usage.


      ACCEPT:

      1) All 9 commands accept --explain flag

      2) Each --explain output includes: command purpose, 1-2 usage examples

      3) Examples follow existing pattern from task claim (see _show_explain functions)

      4) Both --json and human-readable --explain work

      5) uv run pytest passes


      CONTEXT: See task claim''s _show_explain() in task.py as canonical pattern.
      Each explain should include ''command'', ''purpose'', ''examples'' keys for
      JSON output. Human output uses Rich console.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - cli
    - help
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T01:30:03.414256+00:00'
    updated_at: '2025-12-28T01:36:53.917541+00:00'
  H002:
    title: Differentiate agent brief --format outputs
    description: 'WHAT: Implement distinct output formats for ''lodestar agent brief
      --format'' option. Currently all three formats (claude, copilot, generic) produce
      identical output.


      WHERE: src/lodestar/cli/commands/agent.py (brief_command function), tests/test_cli.py


      WHY: The --format option promises different output tailored to each agent type,
      but delivers the same output. This breaks user expectations and wastes the option.


      ACCEPT:

      1) claude format: XML-style tags (<task>, <context>, <acceptance_criteria>),
      system prompt structure

      2) copilot format: GitHub-flavored markdown with ## headers, instructions block,
      code fences

      3) generic format: Plain structured text with labeled sections (TASK:, CONTEXT:,
      CRITERIA:)

      4) Tests in test_cli.py verify each format contains expected structure markers

      5) --json output includes ''format'' field indicating which was used

      6) uv run pytest passes


      CONTEXT: See brief_command in agent.py around line 200-280. The BriefFormat
      enum already exists. Each format should be optimized for how that agent type
      processes prompts.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - cli
    - agent
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T01:30:13.902206+00:00'
    updated_at: '2025-12-28T01:51:09.838964+00:00'
  H003:
    title: Standardize REQUIRED markers and add docstring examples
    description: 'WHAT: Audit all CLI option definitions and standardize help text.
      Add ''(REQUIRED)'' marker to required options. Add inline examples to command
      docstrings that lack them.


      WHERE: src/lodestar/cli/commands/task.py, src/lodestar/cli/commands/msg.py,
      src/lodestar/cli/commands/export.py


      WHY: Inconsistent help text confuses agents. Some options say ''REQUIRED'',
      others don''t. Some commands have docstring examples, others don''t. Agents
      need clear, consistent guidance.


      ACCEPT:

      1) These options explicitly say ''(REQUIRED)'' in help: task claim --agent,
      task renew --agent, msg send --from, msg send --to, msg send --text

      2) Docstring examples added to: task renew, task release, task done, task verify,
      task delete, task graph, export snapshot

      3) Examples use realistic values (not placeholder text)

      4) Examples appear in --help output (use Typer''s backslash-b formatting)

      5) uv run pytest passes


      CONTEXT: See task claim docstring for example format using backslash-b. Typer
      preserves formatting after backslash-b. Use realistic task IDs like F001, agent
      IDs like A1234567.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - cli
    - help
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T01:30:24.867188+00:00'
    updated_at: '2025-12-28T01:51:10.609017+00:00'
  H004:
    title: Update CLI documentation with missing commands
    description: 'WHAT: Update CLI documentation index to include all commands. Add
      missing commands to summary tables and ensure cross-references are complete.


      WHERE: docs/cli/index.md, docs/cli/task.md, docs/cli/msg.md, docs/cli/agent.md


      WHY: CLI docs index tables are missing several commands that exist in the codebase:
      task context, msg search, msg wait, agent find, agent brief. Agents consulting
      docs won''t discover these commands.


      ACCEPT:

      1) docs/cli/index.md summary tables include ALL commands from the codebase

      2) task context documented in docs/cli/task.md with examples

      3) msg search, msg wait documented in docs/cli/msg.md with examples

      4) agent find, agent brief documented in docs/cli/agent.md with examples

      5) All new sections include --json examples for programmatic usage

      6) uv run mkdocs build succeeds without warnings


      CONTEXT: Run ''uv run lodestar --help'', ''uv run lodestar task --help'', etc.
      to get authoritative command lists. Each command doc should match the --help
      output and add practical examples.'
    acceptance_criteria: []
    depends_on:
    - H001
    - H002
    - H003
    labels:
    - docs
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T01:30:36.406697+00:00'
    updated_at: '2025-12-28T01:55:29.472712+00:00'
  LOCK-001:
    title: Create glob pattern overlap utility module
    description: 'Create src/lodestar/util/locks.py with functions for detecting glob
      pattern overlaps: normalize_glob_pattern(), globs_overlap(), and find_overlapping_patterns().
      Use fnmatch for pattern matching, handle cross-platform paths.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    - lock-conflict
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T06:40:23.446108+00:00'
    updated_at: '2025-12-28T06:47:35.742779+00:00'
  LOCK-002:
    title: Add unit tests for glob overlap utilities
    description: 'Create tests/test_locks.py with test cases for: normalize_glob_pattern
      (backslash conversion, leading ./ removal), globs_overlap (exact match, parent/child,
      siblings, empty patterns), find_overlapping_patterns (multiple overlaps, no
      overlaps).'
    acceptance_criteria: []
    depends_on:
    - LOCK-001
    labels:
    - test
    - lock-conflict
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T06:40:24.920757+00:00'
    updated_at: '2025-12-28T06:50:56.555150+00:00'
  LOCK-003:
    title: Add get_all_active_leases() to RuntimeDatabase
    description: Add method to src/lodestar/runtime/database.py that returns all non-expired
      leases. Used for lock conflict detection during task claim.
    acceptance_criteria: []
    depends_on:
    - LOCK-001
    labels:
    - feature
    - lock-conflict
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T06:40:26.283301+00:00'
    updated_at: '2025-12-28T06:52:49.067778+00:00'
  LOCK-004:
    title: Add --force flag and lock conflict detection to task claim
    description: 'Modify task_claim() in src/lodestar/cli/commands/task.py: Add --force/-f
      option. After TTL parsing, query active leases and check for lock overlaps.
      Display warnings in human output (skip if --force). Include warnings in JSON
      output.'
    acceptance_criteria: []
    depends_on:
    - LOCK-002
    - LOCK-003
    labels:
    - feature
    - lock-conflict
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T06:40:38.855410+00:00'
    updated_at: '2025-12-28T06:55:00.328641+00:00'
  LOCK-005:
    title: Add CLI integration tests for lock conflict detection
    description: 'Add tests to tests/test_cli.py: claiming with lock conflict shows
      warning, --force bypasses warning, JSON output includes warnings in warnings
      array.'
    acceptance_criteria: []
    depends_on:
    - LOCK-004
    labels:
    - test
    - lock-conflict
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T06:40:40.222858+00:00'
    updated_at: '2025-12-28T06:57:17.693844+00:00'
  LOCK-006:
    title: Update documentation for lock conflict detection
    description: Update docs/cli/task.md with --force flag documentation and lock
      conflict behavior. Update CLAUDE.md CLI reference.
    acceptance_criteria: []
    depends_on:
    - LOCK-004
    labels:
    - docs
    - lock-conflict
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T06:40:41.605997+00:00'
    updated_at: '2025-12-28T06:59:15.604591+00:00'
  LOCK-007:
    title: Update AGENTS.md and help text for lock conflict awareness
    description: 1. Update _agents_md_content() in src/lodestar/cli/commands/init.py
      to mention the locks field and --force flag for handling file conflicts when
      multiple agents work concurrently. 2. Update --help and --explain output for
      task claim to mention lock conflict warnings and --force override.
    acceptance_criteria: []
    depends_on:
    - LOCK-004
    labels:
    - docs
    - lock-conflict
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T06:43:15.836372+00:00'
    updated_at: '2025-12-28T07:01:36.612174+00:00'
  R001:
    title: Extract task_service.py from task.py
    description: Extract business logic (claimable tasks, lease validation, cascade
      delete, dependency traversal) from task.py into core/task_service.py
    acceptance_criteria: []
    depends_on: []
    labels:
    - refactor
    - phase1
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T07:47:32.555848+00:00'
    updated_at: '2025-12-28T07:51:11.507256+00:00'
  R002:
    title: Extract task_formatter.py
    description: Extract Rich table formatting, JSON envelope generation, and graph
      output from task.py into cli/formatters/task_formatter.py
    acceptance_criteria: []
    depends_on: []
    labels:
    - refactor
    - phase1
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T07:47:34.612115+00:00'
    updated_at: '2025-12-28T07:53:20.121868+00:00'
  R003:
    title: Extract PRD utilities to util/prd.py
    description: Extract PRD context extraction and drift detection logic from task.py
      into util/prd.py
    acceptance_criteria: []
    depends_on: []
    labels:
    - refactor
    - phase1
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T07:47:36.705423+00:00'
    updated_at: '2025-12-28T07:51:26.433430+00:00'
  R004:
    title: Slim down task.py CLI commands
    description: 'Refactor task.py to use extracted services/formatters. Target: ~400
      lines. Each command: parse args, call service, format output'
    acceptance_criteria: []
    depends_on:
    - R001
    - R002
    - R003
    labels:
    - refactor
    - phase1
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T07:47:50.606771+00:00'
    updated_at: '2025-12-28T07:58:06.146964+00:00'
  R005:
    title: Extract agent_repo.py from RuntimeDatabase
    description: Create runtime/repositories/agent_repo.py with agent registration,
      queries, and heartbeat methods
    acceptance_criteria: []
    depends_on:
    - R004
    labels:
    - refactor
    - phase2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T07:47:52.769960+00:00'
    updated_at: '2025-12-28T10:04:35.272203+00:00'
  R006:
    title: Extract lease_repo.py from RuntimeDatabase
    description: Create runtime/repositories/lease_repo.py with lease create, renew,
      release, and query methods
    acceptance_criteria: []
    depends_on:
    - R004
    labels:
    - refactor
    - phase2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T07:47:54.850288+00:00'
    updated_at: '2025-12-28T10:04:38.803860+00:00'
  R007:
    title: Extract message_repo.py from RuntimeDatabase
    description: Create runtime/repositories/message_repo.py with send, inbox, thread,
      search, and wait methods
    acceptance_criteria: []
    depends_on:
    - R004
    labels:
    - refactor
    - phase2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T07:47:57.003594+00:00'
    updated_at: '2025-12-28T10:04:42.590252+00:00'
  R008:
    title: Convert database.py to facade
    description: 'Refactor RuntimeDatabase to thin facade delegating to repositories.
      Target: ~100 lines. Maintain backward compatibility'
    acceptance_criteria: []
    depends_on:
    - R005
    - R006
    - R007
    labels:
    - refactor
    - phase2
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T07:48:10.766240+00:00'
    updated_at: '2025-12-28T10:06:10.463757+00:00'
  R009:
    title: Extract timestamps.py utility
    description: Create util/timestamps.py with parse_iso_timestamp() and format_relative_time()
      - consolidate 3 duplicated implementations
    acceptance_criteria: []
    depends_on:
    - R008
    labels:
    - refactor
    - phase3
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T07:48:12.924101+00:00'
    updated_at: '2025-12-28T10:08:24.537880+00:00'
  R010:
    title: Extract message_service.py
    description: Create core/message_service.py with inbox query building, search
      logic, and thread assembly
    acceptance_criteria: []
    depends_on:
    - R009
    labels:
    - refactor
    - phase3
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T07:48:14.999851+00:00'
    updated_at: '2025-12-28T10:08:54.729446+00:00'
  R011:
    title: Slim down msg.py CLI commands
    description: 'Refactor msg.py to use extracted services. Target: ~300 lines'
    acceptance_criteria: []
    depends_on:
    - R010
    labels:
    - refactor
    - phase3
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T07:48:17.119747+00:00'
    updated_at: '2025-12-28T10:08:58.562217+00:00'
  R012:
    title: Extract agent_service.py
    description: Create core/agent_service.py with agent registration, discovery,
      and brief generation logic
    acceptance_criteria: []
    depends_on:
    - R011
    labels:
    - refactor
    - phase4
    locks: []
    priority: 4
    status: verified
    created_at: '2025-12-28T07:48:27.674622+00:00'
    updated_at: '2025-12-28T10:12:46.197721+00:00'
  R013:
    title: Extract brief_formatter.py with strategy pattern
    description: Create cli/formatters/brief_formatter.py with BriefFormatter base
      class and Claude/Copilot/Generic implementations
    acceptance_criteria: []
    depends_on:
    - R012
    labels:
    - refactor
    - phase4
    locks: []
    priority: 4
    status: verified
    created_at: '2025-12-28T07:48:29.807095+00:00'
    updated_at: '2025-12-28T10:12:50.257155+00:00'
  R014:
    title: Slim down agent.py CLI commands
    description: 'Refactor agent.py to use extracted services/formatters. Target:
      ~400 lines'
    acceptance_criteria: []
    depends_on:
    - R013
    labels:
    - refactor
    - phase4
    locks: []
    priority: 4
    status: verified
    created_at: '2025-12-28T07:48:31.933929+00:00'
    updated_at: '2025-12-28T10:12:54.316816+00:00'
  MCP-001:
    title: Add MCP SDK dependency as optional extra
    description: 'Add the official MCP Python SDK (mcp) as an optional dependency.
      Create lodestar-cli[mcp] extra in pyproject.toml. Decision needed: ship by default
      or optional (PRD recommends deciding during implementation).'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:03:46.993900+00:00'
    updated_at: '2025-12-28T13:14:31.769523+00:00'
  MCP-002:
    title: Create MCP package structure
    description: Create src/lodestar/mcp/ package with __init__.py. Establish module
      structure for server.py (FastMCP setup), tools/ subpackage, resources.py, and
      utils.py. Keep files focused and small.
    acceptance_criteria: []
    depends_on:
    - MCP-001
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:03:48.857625+00:00'
    updated_at: '2025-12-28T13:16:50.471132+00:00'
  MCP-003:
    title: Add events table to runtime.sqlite
    description: 'Add runtime table for event stream persistence: id (INTEGER PRIMARY
      KEY, monotonic cursor), created_at (TEXT ISO8601), type (TEXT - task.claimed,
      task.done, task.verified, message.sent, lease.expired, agent.joined), actor_agent_id
      (TEXT NULL), task_id (TEXT NULL), target_agent_id (TEXT NULL), payload_json
      (TEXT), correlation_id (TEXT). Add migration.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:03:50.698545+00:00'
    updated_at: '2025-12-28T13:23:32.650259+00:00'
  MCP-004:
    title: Create event logging hooks infrastructure
    description: Create event logging service that appends events on every mutating
      operation. Integrate with existing services (task, agent, message) to emit events.
      Events MUST be appended atomically with mutations.
    acceptance_criteria: []
    depends_on:
    - MCP-003
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:03:52.529071+00:00'
    updated_at: '2025-12-28T14:44:07.455598+00:00'
  MCP-005:
    title: Implement lodestar mcp serve command
    description: 'Add new CLI group: lodestar mcp serve [--repo PATH] [--stdio] [--log-file
      PATH] [--json-logs] [--dev]. Defaults: --stdio is default transport. Server
      logs go to stderr; optionally also to a file. Must not emit non-protocol output
      on stdout.'
    acceptance_criteria: []
    depends_on:
    - MCP-002
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:04:16.551602+00:00'
    updated_at: '2025-12-28T14:48:31.202509+00:00'
  MCP-006:
    title: Create FastMCP server setup with stdio transport
    description: 'Create mcp/server.py with FastMCP initialization. Configure stdio
      transport (JSON-RPC messages delimited by newlines). Handle server lifecycle:
      repo root resolution, open/create runtime DB connection, instantiate Lodestar
      application services.'
    acceptance_criteria: []
    depends_on:
    - MCP-005
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:04:18.336233+00:00'
    updated_at: '2025-12-28T14:50:07.472647+00:00'
  MCP-007:
    title: Implement repo targeting logic
    description: Implement --repo flag support and automatic repo discovery. If repo
      root not provided, walk upwards from CWD until .lodestar/ directory found; otherwise
      return clear error in tool results. Integrate with server initialization.
    acceptance_criteria: []
    depends_on:
    - MCP-006
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:04:20.179735+00:00'
    updated_at: '2025-12-28T14:51:53.378281+00:00'
  MCP-010:
    title: Implement lodestar.repo.status tool
    description: 'Create mcp/tools/repo.py. Implement lodestar.repo.status tool: returns
      repoRoot, specPath, runtimePath, counts (tasks by status, active leases, agents
      online, unread messages), suggestedNextActions. Return both text summary and
      structuredContent.'
    acceptance_criteria: []
    depends_on:
    - MCP-007
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:04:38.859116+00:00'
    updated_at: '2025-12-28T15:13:35.097147+00:00'
  MCP-011:
    title: Implement lodestar.agent.join tool
    description: 'Create mcp/tools/agent.py. Implement lodestar.agent.join: inputs
      - name, client, model, capabilities, ttlSeconds (all optional). Returns agentId,
      leaseDefaults, serverTime, notes. Register/announce agent identity. This is
      the only mutating tool that doesn''t require agentId.'
    acceptance_criteria: []
    depends_on:
    - MCP-007
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:04:40.729869+00:00'
    updated_at: '2025-12-28T15:16:17.406883+00:00'
  MCP-012:
    title: Implement lodestar.agent.heartbeat tool
    description: 'Add to mcp/tools/agent.py. Implement lodestar.agent.heartbeat: input
      - agentId (required). Returns ok, expiresAt, warnings. Refresh agent presence.'
    acceptance_criteria: []
    depends_on:
    - MCP-011
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:04:42.831203+00:00'
    updated_at: '2025-12-28T15:18:57.369238+00:00'
  MCP-013:
    title: Implement lodestar.agent.leave tool
    description: 'Add to mcp/tools/agent.py. Implement lodestar.agent.leave: inputs
      - agentId (required), reason (optional). Returns ok. Mark agent offline gracefully.'
    acceptance_criteria: []
    depends_on:
    - MCP-012
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:04:44.761750+00:00'
    updated_at: '2025-12-28T15:27:16.428783+00:00'
  MCP-020:
    title: Implement lodestar.task.list tool
    description: 'Create mcp/tools/task.py. Implement lodestar.task.list: inputs -
      status (optional: ready|done|verified|deleted|all), label (optional), limit
      (default 50, max 200), cursor (optional). Returns tasks array of TaskSummary
      (id, title, status, priority, labels, dependencies, claimedByAgentId, leaseExpiresAt,
      updatedAt), nextCursor.'
    acceptance_criteria: []
    depends_on:
    - MCP-007
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:05:13.034182+00:00'
    updated_at: '2025-12-28T15:36:01.638974+00:00'
  MCP-021:
    title: Implement lodestar.task.get tool
    description: 'Add to mcp/tools/task.py. Implement lodestar.task.get: input - taskId
      (required). Returns task (TaskDetail with description, acceptance criteria,
      PRD context fields, dependency graph info), runtime (status, claimedBy, lease,
      timestamps), warnings (drift detection, missing PRD source).'
    acceptance_criteria: []
    depends_on:
    - MCP-020
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:05:14.919762+00:00'
    updated_at: '2025-12-28T15:41:01.061867+00:00'
  MCP-022:
    title: Implement lodestar.task.next tool
    description: 'Add to mcp/tools/task.py. Implement lodestar.task.next: inputs -
      agentId (optional for personalization), limit (default 5, max 20). Returns candidates
      (TaskSummary[] filtered to claimable ready tasks), rationale. Dependency-aware
      ''what should I do next'' tool.'
    acceptance_criteria: []
    depends_on:
    - MCP-021
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:05:16.806230+00:00'
    updated_at: '2025-12-28T15:45:20.656446+00:00'
  MCP-023:
    title: Implement lodestar.task.context tool
    description: 'Add to mcp/tools/task.py. Implement lodestar.task.context: input
      - taskId (required). Returns context object with prdSource, prdRef, prdExcerpt,
      drift detection (changed, details). Delivers ''just enough PRD context'' as
      Lodestar already supports.'
    acceptance_criteria: []
    depends_on:
    - MCP-022
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:05:18.723263+00:00'
    updated_at: '2025-12-28T15:48:41.639690+00:00'
  MCP-030:
    title: Implement lodestar.task.claim tool
    description: 'Create mcp/tools/task_mutations.py. Implement lodestar.task.claim:
      inputs - taskId (required), agentId (required), ttlSeconds (optional, server
      clamps to bounds), force (optional, attempt claim on expired lease). Returns
      ok, lease object (taskId, agentId, expiresAt, ttlSeconds), conflict object on
      failure.'
    acceptance_criteria: []
    depends_on:
    - MCP-007
    - MCP-004
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:05:58.395431+00:00'
    updated_at: '2025-12-28T15:51:33.749176+00:00'
  MCP-031:
    title: Implement lodestar.task.release tool
    description: 'Add to mcp/tools/task_mutations.py. Implement lodestar.task.release:
      inputs - taskId (required), agentId (required), reason (optional). Returns ok,
      previousLease. Release claim before TTL expiry.'
    acceptance_criteria: []
    depends_on:
    - MCP-030
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:06:00.336794+00:00'
    updated_at: '2025-12-28T15:56:15.385208+00:00'
  MCP-032:
    title: Implement lodestar.task.done tool
    description: 'Add to mcp/tools/task_mutations.py. Implement lodestar.task.done:
      inputs - taskId (required), agentId (required), note (optional). Returns ok,
      status (done), warnings (e.g. ''not claimed by you''). Mark task done (pending
      verification).'
    acceptance_criteria: []
    depends_on:
    - MCP-031
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:06:02.319977+00:00'
    updated_at: '2025-12-28T15:58:22.625722+00:00'
  MCP-033:
    title: Implement lodestar.task.verify tool
    description: 'Add to mcp/tools/task_mutations.py. Implement lodestar.task.verify:
      inputs - taskId (required), agentId (required), note (optional). Returns ok,
      status (verified), newlyReadyTaskIds (unblocked dependents). Mark task verified.'
    acceptance_criteria: []
    depends_on:
    - MCP-032
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:06:04.304151+00:00'
    updated_at: '2025-12-28T16:00:30.809553+00:00'
  MCP-040:
    title: Implement lodestar.message.send tool
    description: 'Create mcp/tools/message.py. Implement lodestar.message.send: inputs
      - fromAgentId (required), toAgentId (optional for broadcast), taskId (optional),
      subject (optional), body (required, max 16KB enforced), severity (optional:
      info|warning|handoff|blocker). Returns ok, messageId, deliveredTo array.'
    acceptance_criteria: []
    depends_on:
    - MCP-007
    - MCP-004
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:06:19.469696+00:00'
    updated_at: '2025-12-28T16:02:55.895982+00:00'
  MCP-041:
    title: Implement lodestar.message.list tool
    description: 'Add to mcp/tools/message.py. Implement lodestar.message.list: inputs
      - agentId (required), unreadOnly (optional, default true), limit (default 50,
      max 200), sinceId (optional for incremental). Returns messages array (id, createdAt,
      from, to, taskId, subject, body, severity, readAt), nextCursor.'
    acceptance_criteria: []
    depends_on:
    - MCP-040
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:06:21.359747+00:00'
    updated_at: '2025-12-28T16:12:41.683791+00:00'
  MCP-042:
    title: Implement lodestar.message.ack tool
    description: 'Add to mcp/tools/message.py. Implement lodestar.message.ack: inputs
      - agentId (required), messageIds (required list). Returns ok, updated count.
      Mark messages as read.'
    acceptance_criteria: []
    depends_on:
    - MCP-041
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:06:23.389858+00:00'
    updated_at: '2025-12-28T16:16:14.151266+00:00'
  MCP-050:
    title: Implement lodestar.events.pull tool
    description: 'Create mcp/tools/events.py. Implement lodestar.events.pull: inputs
      - sinceCursor (optional, default 0), limit (default 200, max 1000), filterTypes
      (optional string array). Returns events array (id, createdAt, type, actorAgentId,
      taskId, targetAgentId, payload), nextCursor. Pull-based fallback for hosts without
      reliable push.'
    acceptance_criteria: []
    depends_on:
    - MCP-004
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:06:33.182026+00:00'
    updated_at: '2025-12-28T16:20:01.104320+00:00'
  MCP-060:
    title: Add structured logging via notifications/message
    description: Implement MCP notifications/message for structured logs (level, logger
      name, data). Emit logs when events occur. Use MCP logging specification. Server
      SHOULD emit lightweight notifications when events are appended.
    acceptance_criteria: []
    depends_on:
    - MCP-050
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:06:56.548405+00:00'
    updated_at: '2025-12-28T16:29:41.512979+00:00'
  MCP-061:
    title: Add progress support for long operations
    description: Implement MCP notifications/progress. If client provides progress
      token in request metadata, long-running operations SHOULD emit progress updates.
      Design for task.verify and future expensive operations.
    acceptance_criteria: []
    depends_on:
    - MCP-060
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:06:58.586545+00:00'
    updated_at: '2025-12-28T16:50:11.117700+00:00'
  MCP-062:
    title: Add background event watcher for push notifications
    description: Create optional background watcher loop that tails the DB-backed
      event stream and emits notifications. On event write, emit compact notification/message
      summary and/or resource-changed hints. Best-effort push for clients that support
      it.
    acceptance_criteria: []
    depends_on:
    - MCP-061
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:07:00.565574+00:00'
    updated_at: '2025-12-28T17:10:49.814006+00:00'
  MCP-070:
    title: Implement lodestar://spec resource
    description: Create mcp/resources.py. Implement lodestar://spec resource that
      returns content of .lodestar/spec.yaml as text (mime text/yaml). Resources are
      read-only; allows clients to fetch without tool approval flows.
    acceptance_criteria: []
    depends_on:
    - MCP-007
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:07:22.230780+00:00'
    updated_at: '2025-12-28T17:24:55.787726+00:00'
  MCP-071:
    title: Implement lodestar://status resource
    description: Add to mcp/resources.py. Implement lodestar://status resource that
      returns JSON summary similar to repo.status (mime application/json). Read-only
      resource.
    acceptance_criteria: []
    depends_on:
    - MCP-070
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:07:24.178009+00:00'
    updated_at: '2025-12-29T03:15:46.644059+00:00'
  MCP-072:
    title: Implement lodestar://task/{taskId} resource
    description: Add to mcp/resources.py. Implement lodestar://task/{taskId} resource
      that returns JSON representation of a task (mime application/json). Read-only
      resource for individual task access.
    acceptance_criteria: []
    depends_on:
    - MCP-071
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:07:26.215518+00:00'
    updated_at: '2025-12-29T03:21:30.351115+00:00'
  MCP-080:
    title: Implement lodestar_agent_workflow prompt template
    description: 'Create mcp/prompts.py. Implement lodestar_agent_workflow prompt:
      short workflow recipe (join -> next -> claim -> context -> done -> verify ->
      message handoff). Optional - not all hosts surface prompts well.'
    acceptance_criteria: []
    depends_on:
    - MCP-072
    labels:
    - feature
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T13:07:37.767382+00:00'
    updated_at: '2025-12-29T04:49:37.833437+00:00'
    completed_by: ACC24654F
    completed_at: 2025-12-29 04:49:36.339301+00:00
    verified_by: ACC24654F
    verified_at: 2025-12-29 04:49:37.833460+00:00
  MCP-081:
    title: Implement lodestar_task_execute prompt template
    description: 'Add to mcp/prompts.py. Implement lodestar_task_execute prompt: asks
      agent to follow acceptance criteria and produce verification checklist. Optional
      feature.'
    acceptance_criteria: []
    depends_on:
    - MCP-080
    labels:
    - feature
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T13:07:39.724105+00:00'
    updated_at: '2025-12-29T05:15:20.288858+00:00'
    completed_by: AECE94C59
    completed_at: 2025-12-29 05:15:07.238736+00:00
    verified_by: AECE94C59
    verified_at: 2025-12-29 05:15:20.288948+00:00
  MCP-090:
    title: Add unit tests for MCP tool input validation
    description: 'Create tests/test_mcp_tools.py. Add unit tests for: bad ids, bad
      TTLs, missing repo, max length enforcement, required agentId validation. Test
      that outputSchemas match expected types. Comprehensive validation testing.'
    acceptance_criteria: []
    depends_on:
    - MCP-050
    labels:
    - test
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:08:07.431318+00:00'
    updated_at: '2025-12-29T03:40:39.094179+00:00'
  MCP-091:
    title: Add integration tests for MCP server
    description: 'Create tests/test_mcp_integration.py. Spawn MCP server subprocess
      and connect with MCP client library over stdio. Test: concurrent claims from
      two client sessions, message send/receive/ack, event stream consumption. Use
      shared repo fixture.'
    acceptance_criteria: []
    depends_on:
    - MCP-090
    labels:
    - test
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:08:09.391281+00:00'
    updated_at: '2025-12-29T04:15:00.549401+00:00'
  MCP-092:
    title: Add docs/mcp.md documentation
    description: 'Create docs/mcp.md explaining: how to run lodestar mcp serve, example
      host configurations (VS Code, Claude Desktop), troubleshooting (stderr logs,
      MCP Inspector testing), tool reference with inputs/outputs, resources reference.'
    acceptance_criteria: []
    depends_on:
    - MCP-091
    labels:
    - docs
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:08:11.442777+00:00'
    updated_at: '2025-12-29T04:27:09.407003+00:00'
  MCP-093:
    title: Manual acceptance testing with MCP Inspector
    description: 'Manually test: lodestar mcp serve --repo starts and completes MCP
      initialization in MCP Inspector. Verify join -> next -> claim -> get/context
      -> done -> verify workflow. Document any issues found.'
    acceptance_criteria: []
    depends_on:
    - MCP-092
    labels:
    - test
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-28T13:08:13.474317+00:00'
    updated_at: '2025-12-29T05:53:38.280007+00:00'
    completed_by: A016709FC
    completed_at: 2025-12-29 05:53:31.557634+00:00
    verified_by: A016709FC
    verified_at: 2025-12-29 05:53:38.280029+00:00
  MCP-094:
    title: Test MCP server with real host (VS Code or similar)
    description: 'Test MCP server with at least one full spec host (VS Code, Visual
      Studio, or Claude Desktop). Verify: two clients can coordinate via same repo,
      task state transitions work, events.pull fallback functions correctly.'
    acceptance_criteria: []
    depends_on:
    - MCP-093
    labels:
    - test
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-28T13:08:15.506660+00:00'
    updated_at: '2025-12-29T07:21:22.609196+00:00'
    completed_by: A15137B88
    completed_at: 2025-12-29 07:21:13.950728+00:00
    verified_by: A15137B88
    verified_at: 2025-12-29 07:21:22.609211+00:00
  MCP-008:
    title: Implement structured output helpers for MCP tools
    description: 'Create mcp/output.py with helpers for structured tool responses.
      Every tool returns: human-readable text summary, structuredContent (machine-parseable),
      outputSchema for stable integration. Standardize response format across all
      tools.'
    acceptance_criteria: []
    depends_on:
    - MCP-006
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:08:29.382993+00:00'
    updated_at: '2025-12-28T14:53:45.718639+00:00'
  MCP-009:
    title: Implement input validation and safety guards
    description: 'Create mcp/validation.py with input validators. Enforce: max message
      length 16KB, max list limits, TTL clamp (min 60s, max 2h), agentId required
      for mutating tools (except agent.join). All inputs must be validated before
      processing.'
    acceptance_criteria: []
    depends_on:
    - MCP-006
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-28T13:08:31.204589+00:00'
    updated_at: '2025-12-28T14:55:27.920671+00:00'
  CLI-001:
    title: Add --agent parameter to task done and verify commands
    description: 'The CLI commands ''task done'' and ''task verify'' don''t accept
      --agent parameters, but the MCP tools require agent_id. This creates confusion
      and inconsistency.\n\nAdd optional --agent parameter to both commands:\n- Auto-detect
      from active lease on the task if not provided\n- Store agent ID in spec for
      audit trail (add completed_by, verified_by fields)\n- Update help text to mention
      the parameter\n- Ensure consistency with MCP tool signatures\n\nThis prevents
      errors like ''No such option: --agent'' when users expect CLI/MCP parity.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - enhancement
    - cli
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-29T04:29:10.532732+00:00'
    updated_at: '2025-12-29T04:34:38.426640+00:00'
    completed_by: AAF674DE5
    completed_at: 2025-12-29 04:34:23.689872+00:00
    verified_by: AAF674DE5
    verified_at: 2025-12-29 04:34:38.426658+00:00
  MCP-TEST-1:
    title: MCP Copilot Test Task 1
    description: Safe test task for VS Code Copilot MCP testing
    acceptance_criteria: []
    depends_on: []
    labels:
    - test
    locks: []
    priority: 50
    status: verified
    created_at: '2025-12-29T06:08:19.513174+00:00'
    updated_at: '2025-12-29T06:45:13.133372+00:00'
    completed_by: A1977EEDB
    completed_at: 2025-12-29 06:44:35.587840+00:00
    verified_by: A1977EEDB
    verified_at: 2025-12-29 06:45:13.133396+00:00
  MCP-TEST-2:
    title: MCP Copilot Test Task 2
    description: Second safe test task for coordination testing
    acceptance_criteria: []
    depends_on: []
    labels:
    - test
    locks: []
    priority: 50
    status: verified
    created_at: '2025-12-29T06:08:21.268903+00:00'
    updated_at: '2025-12-29T06:48:25.238651+00:00'
    completed_by: A1656327B
    completed_at: 2025-12-29 06:48:21.262965+00:00
    verified_by: A1656327B
    verified_at: 2025-12-29 06:48:25.238654+00:00
  MCP-TEST-3:
    title: MCP Copilot Test Task 3
    description: Third safe test task for lifecycle testing
    acceptance_criteria: []
    depends_on: []
    labels:
    - test
    locks: []
    priority: 50
    status: verified
    created_at: '2025-12-29T06:08:22.967380+00:00'
    updated_at: '2025-12-29T07:26:53.317666+00:00'
    completed_by: A15137B88
    completed_at: 2025-12-29 07:26:47.881940+00:00
    verified_by: A15137B88
    verified_at: 2025-12-29 07:26:53.317681+00:00
  MCP-095:
    title: 'Fix MCP tool names: replace dots with underscores/hyphens'
    description: VS Code rejects tool names with dots. Rename all MCP tools from lodestar.X.Y
      to lodestar_X_Y or lodestar-X-Y format. Affects all 16 tools. Update tests and
      documentation.
    acceptance_criteria: []
    depends_on:
    - MCP-094
    labels:
    - bug
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-29T06:14:26.395681+00:00'
    updated_at: '2025-12-29T07:22:40.683553+00:00'
    completed_by: A15137B88
    completed_at: 2025-12-29 07:22:35.638499+00:00
    verified_by: A15137B88
    verified_at: 2025-12-29 07:22:40.683568+00:00
  MCP-096:
    title: Implement missing lodestar.agent.list MCP tool
    description: Add lodestar.agent.list MCP tool to list all registered agents. Should
      match CLI 'lodestar agent list' functionality. Include filtering options.
    acceptance_criteria: []
    depends_on:
    - MCP-094
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-29T06:14:28.013560+00:00'
    updated_at: '2025-12-29T07:25:45.453927+00:00'
    completed_by: A15137B88
    completed_at: 2025-12-29 07:25:36.645760+00:00
    verified_by: A15137B88
    verified_at: 2025-12-29 07:25:45.453942+00:00
  W001:
    title: Add retry logic for Windows file operations
    description: 'WHAT: Implement exponential backoff retry logic for file system
      operations on Windows.


      WHERE: src/lodestar/spec/loader.py (atomic save operations)


      WHY: Windows file system has brief locks during atomic rename operations that
      cause ''[WinError 5] Access is denied'' errors. This occurred ~5 times out of
      12 task verifications during testing.


      ACCEPT:

      1) Atomic file operations retry up to 3 times with exponential backoff (50ms,
      100ms, 200ms)

      2) Only retry on transient file system errors (WinError 5, 32, 33)

      3) Non-retriable errors fail immediately with clear message

      4) All existing tests pass

      5) Add Windows-specific retry test


      CONTEXT: Error pattern in LODESTAR_MCP_FEEDBACK.md. The save_spec() function
      in spec/loader.py does atomic rename that fails on Windows.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - bug
    locks: []
    priority: 1
    status: verified
    created_at: '2025-12-29T16:48:05.733646+00:00'
    updated_at: '2025-12-29T16:54:33.011432+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 16:54:27.981807+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 16:54:33.011445+00:00
  W002:
    title: Improve error messages for file operations
    description: 'WHAT: Distinguish between transient and permanent file system errors
      in error messages.


      WHERE: src/lodestar/spec/loader.py, src/lodestar/mcp/tools/


      WHY: Current error messages don''t indicate whether an error is retriable, forcing
      agents to guess. Better messages improve agent workflow.


      ACCEPT:

      1) Error responses include ''retriable'' boolean field where applicable

      2) Transient errors (file locks) have clear ''retry immediately'' guidance

      3) Permanent errors (permissions, missing files) have actionable guidance

      4) MCP tool errors return structured error info with suggested_action field

      5) Error message includes current task status even on failure


      CONTEXT: See LODESTAR_MCP_FEEDBACK.md recommendation for partial status response
      on failure.'
    acceptance_criteria: []
    depends_on:
    - W001
    labels:
    - feature
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-29T16:48:14.277069+00:00'
    updated_at: '2025-12-29T16:59:11.920552+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 16:59:07.637136+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 16:59:11.920615+00:00
  W003:
    title: Normalize Windows paths in error messages
    description: 'WHAT: Ensure all file paths in error messages use platform-appropriate
      separators.


      WHERE: src/lodestar/spec/loader.py, src/lodestar/util/paths.py, src/lodestar/mcp/


      WHY: Some error messages show Unix-style paths even on Windows, which is confusing
      for users.


      ACCEPT:

      1) All error messages use os.path.normpath() or pathlib.Path for paths

      2) Paths are consistent with the platform''s native format

      3) Add test verifying path format in error messages on Windows

      4) No breaking changes to existing functionality


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''Better Windows Path Handling'' section.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - bug
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-29T16:48:21.329666+00:00'
    updated_at: '2025-12-29T17:16:15.657022+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 17:16:11.135436+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 17:16:15.657038+00:00
  F050:
    title: Add combined task_complete MCP tool
    description: 'WHAT: Add a new MCP tool that combines task_done + task_verify in
      a single atomic operation.


      WHERE: src/lodestar/mcp/tools/


      WHY: If an agent crashes between done and verify, the task remains in ''done''
      state indefinitely. A combined operation prevents this failure mode.


      ACCEPT:

      1) New lodestar_task_complete tool that marks task done AND verified atomically

      2) Both operations succeed or neither does (transactional)

      3) Returns list of unblocked dependent tasks (same as verify)

      4) Tool is documented in MCP docs

      5) Integration test covering crash-recovery scenario


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''No Atomic Transaction Support'' section.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-29T16:48:29.990677+00:00'
    updated_at: '2025-12-29T17:21:33.058528+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 17:21:28.902176+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 17:21:33.058544+00:00
  F051:
    title: Add batch verification MCP tool
    description: 'WHAT: Add a new MCP tool for verifying multiple tasks in a single
      operation.


      WHERE: src/lodestar/mcp/tools/


      WHY: When completing multiple independent tasks in sequence, batch operations
      reduce round-trips and improve efficiency.


      ACCEPT:

      1) New lodestar_task_batch_verify tool accepting array of task_ids

      2) Returns summary of successes and failures for each task

      3) Partial success is allowed (some tasks may fail)

      4) All dependent task unblocking happens correctly

      5) Integration test with 3+ tasks


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''Bulk Operations'' feature request.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    locks: []
    priority: 4
    status: verified
    created_at: '2025-12-29T16:48:37.631726+00:00'
    updated_at: '2025-12-29T18:21:36.205301+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 18:21:31.714641+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 18:21:36.205316+00:00
  F052:
    title: Add label/priority filtering to task_next
    description: 'WHAT: Add optional filtering parameters to the task_next MCP tool.


      WHERE: src/lodestar/mcp/tools/task.py


      WHY: Agents may want to focus on specific types of work (e.g., only frontend
      tasks) or skip low-priority items.


      ACCEPT:

      1) task_next accepts optional ''labels'' array parameter

      2) task_next accepts optional ''max_priority'' integer parameter

      3) Filtering is applied before returning candidates

      4) Documentation updated with new parameters

      5) Unit tests for filtering logic


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''Task Filtering Enhancement'' feature request.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - feature
    locks: []
    priority: 5
    status: verified
    created_at: '2025-12-29T16:48:45.756571+00:00'
    updated_at: '2025-12-29T18:26:40.333368+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 18:26:35.825141+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 18:26:40.333386+00:00
  T010:
    title: Add concurrent verification tests
    description: 'WHAT: Add tests for concurrent task operations to catch file locking
      issues.


      WHERE: tests/


      WHY: Race conditions during concurrent verification were discovered during Windows
      testing. Need automated tests to prevent regression.


      ACCEPT:

      1) Test: Two agents verify different tasks simultaneously

      2) Test: Simulate file locks and verify retry logic works

      3) Test: Back-to-back done->verify on same task

      4) All tests pass on Windows and Linux

      5) Tests use threading or asyncio for true concurrency


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''Testing Recommendations'' section.'
    acceptance_criteria: []
    depends_on:
    - W001
    labels:
    - test
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-29T16:48:54.648379+00:00'
    updated_at: '2025-12-29T17:48:39.976757+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 17:48:35.613755+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 17:48:39.976774+00:00
  T011:
    title: Add Windows CI workflow
    description: 'WHAT: Add Windows-specific GitHub Actions CI workflow.


      WHERE: .github/workflows/


      WHY: File system race conditions on Windows are not caught by Linux-only CI.
      Need Windows CI to prevent regression.


      ACCEPT:

      1) GitHub Actions workflow runs tests on windows-latest

      2) Workflow triggers on push and PR to main

      3) Uses same Python version as Linux CI

      4) All tests pass on Windows

      5) Workflow completes in reasonable time (<10 min)


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''Testing Recommendations'' section.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - test
    locks: []
    priority: 3
    status: verified
    created_at: '2025-12-29T16:49:01.978306+00:00'
    updated_at: '2025-12-29T17:51:36.224541+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 17:51:32.198842+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 17:51:36.224556+00:00
  D030:
    title: Document MCP error handling patterns
    description: 'WHAT: Add error handling documentation to MCP docs.


      WHERE: docs/mcp.md or new docs/guides/error-handling.md


      WHY: Users need to know which errors are retriable vs permanent, and how to
      handle them in agent code.


      ACCEPT:

      1) List of retriable vs. non-retriable error types

      2) Recommended retry strategies with code examples

      3) Example error handling code for common scenarios

      4) Linked from main MCP documentation page

      5) Tested code examples


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''Documentation Improvements'' section.'
    acceptance_criteria: []
    depends_on:
    - W001
    - W002
    labels:
    - docs
    locks: []
    priority: 4
    status: verified
    created_at: '2025-12-29T16:49:21.941053+00:00'
    updated_at: '2025-12-29T17:54:03.183298+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 17:53:58.742286+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 17:54:03.183318+00:00
  D031:
    title: Add Windows-specific notes to documentation
    description: 'WHAT: Add Windows-specific guidance and caveats to documentation.


      WHERE: docs/getting-started.md, docs/mcp.md


      WHY: Windows users may encounter file locking issues and need to know mitigation
      strategies.


      ACCEPT:

      1) Warning about potential file locking on Windows

      2) Mitigation strategies documented

      3) Any Windows-specific configuration noted

      4) Performance characteristics section added

      5) Expected operation times documented


      CONTEXT: LODESTAR_MCP_FEEDBACK.md ''Documentation Improvements'' section.'
    acceptance_criteria: []
    depends_on:
    - W001
    labels:
    - docs
    locks: []
    priority: 5
    status: verified
    created_at: '2025-12-29T16:49:28.535697+00:00'
    updated_at: '2025-12-29T18:22:58.615233+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 18:22:53.848532+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 18:22:58.615247+00:00
  UX001:
    title: Add ignored --agent parameter to task query commands
    description: 'WHAT: Add an ignored --agent parameter to task list, task show,
      task context, task next, and task graph commands.


      WHERE: src/lodestar/cli/commands/task.py


      WHY: Agents often develop a pattern of adding --agent to every command after
      using it with mutation commands (claim, done, verify). When they call query
      commands with --agent, they get an error ''No such option: --agent''. This breaks
      agent workflows and causes confusion.


      ACCEPT:

      1. All 5 task query commands accept --agent but ignore it silently

      2. No error when --agent is passed

      3. No changes to output or behavior

      4. Parameter marked as hidden in help (typer.Option(None, hidden=True))

      5. Unit test confirming --agent is accepted silently


      CONTEXT: This is a usability fix for agent workflows. See similar pattern in
      mutation commands that require --agent. The goal is consistent CLI interface
      where --agent never causes an error.'
    acceptance_criteria: []
    depends_on: []
    labels:
    - ux
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-29T18:29:44.441624+00:00'
    updated_at: '2025-12-29T18:33:20.725154+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 18:33:15.746337+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 18:33:20.725172+00:00
  UX002:
    title: Add ignored --agent parameter to agent query commands
    description: 'WHAT: Add an ignored --agent parameter to agent list, agent find,
      and agent brief commands.


      WHERE: src/lodestar/cli/commands/agent.py


      WHY: Agents often develop a pattern of adding --agent to every command after
      using it with task mutation commands. When they call agent query commands with
      --agent, they get an error. This breaks agent workflows.


      ACCEPT:

      1. agent list, agent find, and agent brief accept --agent but ignore it silently

      2. No error when --agent is passed

      3. No changes to output or behavior

      4. Parameter marked as hidden in help (typer.Option(None, hidden=True))

      5. Unit test confirming --agent is accepted silently


      CONTEXT: Part of the consistent --agent handling pattern. See UX001 for related
      task commands.'
    acceptance_criteria: []
    depends_on:
    - UX001
    labels:
    - ux
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-29T18:29:51.817121+00:00'
    updated_at: '2025-12-29T18:35:29.827278+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 18:35:25.249027+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 18:35:29.827318+00:00
  UX003:
    title: Add ignored --agent parameter to msg query commands
    description: 'WHAT: Add an ignored --agent parameter to msg thread and msg search
      commands.


      WHERE: src/lodestar/cli/commands/msg.py


      WHY: Agents often develop a pattern of adding --agent to every command. msg
      inbox and msg wait require --agent, but msg thread and msg search don''t. For
      consistency, all commands should accept --agent without error.


      ACCEPT:

      1. msg thread and msg search accept --agent but ignore it silently

      2. No error when --agent is passed

      3. No changes to output or behavior

      4. Parameter marked as hidden in help (typer.Option(None, hidden=True))

      5. Unit test confirming --agent is accepted silently


      CONTEXT: Part of the consistent --agent handling pattern. See UX001 and UX002
      for related commands.'
    acceptance_criteria: []
    depends_on:
    - UX002
    labels:
    - ux
    locks: []
    priority: 2
    status: verified
    created_at: '2025-12-29T18:29:59.102006+00:00'
    updated_at: '2025-12-29T18:39:56.775273+00:00'
    completed_by: AEB8F7DF9
    completed_at: 2025-12-29 18:38:15.825418+00:00
    verified_by: AEB8F7DF9
    verified_at: 2025-12-29 18:39:56.775289+00:00
  TASK-001:
    title: Create templates module and extract AGENTS.md templates
    description: 'WHAT: Create src/lodestar/cli/templates/agents_md.py module with
      AGENTS_MD_CLI_TEMPLATE and AGENTS_MD_MCP_TEMPLATE f-string constants.

      WHERE: src/lodestar/cli/templates/agents_md.py (new), src/lodestar/cli/commands/init.py

      WHY: Templates exceed 200 lines; extracting improves maintainability (see PRD
      #template-extraction)

      SCOPE: Only extract existing templates; do NOT add new content yet. Create __init__.py
      for templates package.

      ACCEPT: 1) Templates module exists with both constants 2) init.py imports from
      templates 3) lodestar init still works 4) Tests pass

      REFS: Current templates in init.py lines 192-475

      LOCKS: src/lodestar/cli/templates/**, src/lodestar/cli/commands/init.py'
    acceptance_criteria: []
    depends_on: []
    labels:
    - refactor
    locks: []
    priority: 1
    status: verified
    created_at: '2026-01-01T08:49:09.183019+00:00'
    updated_at: '2026-01-01T08:56:56.707460+00:00'
    completed_by: ABF1D05AD
    completed_at: 2026-01-01 08:56:43.135446+00:00
    verified_by: ABF1D05AD
    verified_at: 2026-01-01 08:56:56.707472+00:00
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#template-extraction'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-002:
    title: Add --lock option to task create CLI
    description: 'WHAT: Add repeatable --lock option to lodestar task create command.

      WHERE: src/lodestar/cli/commands/task.py (create_command function)

      WHY: Enable file ownership declaration at task creation (see PRD #cli-options)

      SCOPE: Only add --lock option and wire to Task.locks field. Do NOT add --accept
      or --validate-prd yet.

      ACCEPT: 1) --lock accepts glob patterns 2) Multiple --lock flags work 3) Task
      saved with locks field 4) Help text is clear 5) Tests pass

      REFS: Task model has locks: list[str] field in models/spec.py

      LOCKS: src/lodestar/cli/commands/task.py'
    acceptance_criteria: []
    depends_on:
    - TASK-001
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2026-01-01T08:49:17.591387+00:00'
    updated_at: '2026-01-01T08:58:46.968343+00:00'
    completed_by: ABF1D05AD
    completed_at: 2026-01-01 08:58:36.908713+00:00
    verified_by: ABF1D05AD
    verified_at: 2026-01-01 08:58:46.968356+00:00
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#cli-options'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-003:
    title: Add --accept option to task create CLI
    description: 'WHAT: Add repeatable --accept option to lodestar task create command.

      WHERE: src/lodestar/cli/commands/task.py (create_command function)

      WHY: Enable acceptance criteria at task creation (see PRD #cli-options)

      SCOPE: Only add --accept option and wire to Task.acceptance_criteria field.
      Do NOT add --validate-prd yet.

      ACCEPT: 1) --accept accepts strings 2) Multiple --accept flags work 3) Task
      saved with acceptance_criteria 4) Help text is clear 5) Tests pass

      REFS: Task model has acceptance_criteria: list[str] field in models/spec.py

      LOCKS: src/lodestar/cli/commands/task.py'
    acceptance_criteria: []
    depends_on:
    - TASK-002
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2026-01-01T08:49:23.647110+00:00'
    updated_at: '2026-01-01T08:59:50.995066+00:00'
    completed_by: ABF1D05AD
    completed_at: 2026-01-01 08:59:46.858982+00:00
    verified_by: ABF1D05AD
    verified_at: 2026-01-01 08:59:50.995080+00:00
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#cli-options'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-004:
    title: Add --validate-prd flag to task create CLI
    description: 'WHAT: Add --validate-prd/--no-validate-prd flags to lodestar task
      create.

      WHERE: src/lodestar/cli/commands/task.py (create_command function)

      WHY: Catch PRD reference errors early at task creation (see PRD #cli-options)

      SCOPE: 1) Verify --prd-source file exists 2) Verify --prd-ref anchors exist
      in file 3) Default: validate 4) --no-validate-prd skips checks

      ACCEPT: 1) Missing PRD file fails with clear error 2) Invalid anchor fails with
      clear error 3) --no-validate-prd bypasses checks 4) Success case still works
      5) Tests cover all cases

      REFS: PRD anchor format is {#anchor-name} in markdown headers

      LOCKS: src/lodestar/cli/commands/task.py'
    acceptance_criteria: []
    depends_on:
    - TASK-003
    labels:
    - feature
    locks: []
    priority: 1
    status: verified
    created_at: '2026-01-01T08:49:32.075356+00:00'
    updated_at: '2026-01-01T09:05:00.857439+00:00'
    completed_by: ABF1D05AD
    completed_at: 2026-01-01 09:04:55.422845+00:00
    verified_by: ABF1D05AD
    verified_at: 2026-01-01 09:05:00.857462+00:00
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#cli-options'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-005:
    title: Add locks parameter to MCP task tools
    description: 'WHAT: Add locks parameter to relevant MCP task tools for file ownership.

      WHERE: src/lodestar/mcp/tools/ (task-related tool files)

      WHY: MCP agents need lock conflict warnings same as CLI (see PRD #mcp-tools)

      SCOPE: 1) Add locks to task claim tool if not present 2) Ensure lock conflict
      warnings work via MCP 3) Document that task create is CLI-only

      ACCEPT: 1) MCP task_claim shows lock warnings 2) Lock conflicts detected same
      as CLI 3) Tests cover MCP lock scenarios

      REFS: CLI lock warning behavior in task.py claim_command

      LOCKS: src/lodestar/mcp/tools/**'
    acceptance_criteria: []
    depends_on:
    - TASK-002
    labels:
    - feature
    locks: []
    priority: 2
    status: ready
    created_at: '2026-01-01T08:49:40.636369+00:00'
    updated_at: '2026-01-01T08:49:40.636373+00:00'
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#mcp-tools'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-006:
    title: Rewrite CLI AGENTS.md template with task guidance
    description: 'WHAT: Rewrite AGENTS_MD_CLI_TEMPLATE with comprehensive task creation
      guidance.

      WHERE: src/lodestar/cli/templates/agents_md.py

      WHY: AI agents need structured guidance for well-formed tasks (see PRD #agents-md)

      SCOPE: Add Task Design Principles, Task Description Format (WHAT/WHERE/WHY/SCOPE/ACCEPT/REFS),
      Decomposition Patterns, Acceptance Criteria Writing. Include new --lock, --accept,
      --validate-prd options.

      ACCEPT: 1) Template exceeds 200 lines 2) All new CLI options documented 3) INVEST
      criteria explained 4) 15-minute rule emphasized 5) Examples use proper format

      REFS: PRD sections #task-principles, #task-format, #decomposition, #acceptance-criteria

      LOCKS: src/lodestar/cli/templates/agents_md.py'
    acceptance_criteria: []
    depends_on:
    - TASK-004
    labels:
    - docs
    locks: []
    priority: 2
    status: verified
    created_at: '2026-01-01T08:49:50.533448+00:00'
    updated_at: '2026-01-01T09:17:26.973886+00:00'
    completed_by: ABF1D05AD
    completed_at: 2026-01-01 09:17:14.566619+00:00
    verified_by: ABF1D05AD
    verified_at: 2026-01-01 09:17:26.973898+00:00
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#agents-md'
        lines: null
      - anchor: '#task-principles'
        lines: null
      - anchor: '#task-format'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-007:
    title: Rewrite MCP AGENTS.md template with task guidance
    description: 'WHAT: Rewrite AGENTS_MD_MCP_TEMPLATE with comprehensive task creation
      guidance.

      WHERE: src/lodestar/cli/templates/agents_md.py

      WHY: MCP agents need same guidance, emphasis on CLI-only task creation (see
      PRD #agents-md)

      SCOPE: Mirror CLI template guidance but emphasize: task creation is CLI-only,
      use lodestar_task_context() for PRD, MCP tool reference table.

      ACCEPT: 1) Template exceeds 200 lines 2) CLI-only task creation clearly stated
      3) lodestar_task_context usage documented 4) Same guidance quality as CLI template

      REFS: TASK-006 for CLI template pattern

      LOCKS: src/lodestar/cli/templates/agents_md.py'
    acceptance_criteria: []
    depends_on:
    - TASK-006
    labels:
    - docs
    locks: []
    priority: 2
    status: verified
    created_at: '2026-01-01T08:49:58.198160+00:00'
    updated_at: '2026-01-01T09:36:14.332934+00:00'
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#agents-md'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-008:
    title: Create PRD authoring guide documentation
    description: 'WHAT: Create docs/guides/prd-authoring.md documenting how AI agents
      should structure PRDs.

      WHERE: docs/guides/prd-authoring.md (new file)

      WHY: Well-structured PRDs enable better task decomposition and context delivery
      (see PRD #prd-authoring)

      SCOPE: Cover: Section Anchoring syntax, Task-aligned structure, Scope bounding
      for 15-min leases, Drift-resistant writing, Cross-referencing. Include examples.

      ACCEPT: 1) File created with all sections 2) Anchor syntax documented with examples
      3) Task-aligned structure explained 4) Actionable patterns provided

      REFS: PRD sections #prd-anchoring, #prd-structure, #prd-scope, #prd-drift

      LOCKS: docs/guides/prd-authoring.md'
    acceptance_criteria: []
    depends_on:
    - TASK-001
    labels:
    - docs
    locks: []
    priority: 2
    status: verified
    created_at: '2026-01-01T08:50:07.525080+00:00'
    updated_at: '2026-01-01T09:38:20.021404+00:00'
    completed_by: ABF1D05AD
    completed_at: 2026-01-01 09:38:08.000288+00:00
    verified_by: ABF1D05AD
    verified_at: 2026-01-01 09:38:20.021438+00:00
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#prd-authoring'
        lines: null
      - anchor: '#prd-anchoring'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-009:
    title: Update mkdocs.yml and guides index for PRD authoring
    description: 'WHAT: Add PRD authoring guide to mkdocs navigation and guides index.

      WHERE: mkdocs.yml, docs/guides/index.md

      WHY: New guide must be discoverable in documentation (see PRD #implementation-order)

      SCOPE: 1) Add ''PRD Authoring'' to nav under Guides 2) Add link and description
      in guides/index.md

      ACCEPT: 1) mkdocs.yml nav includes prd-authoring.md 2) guides/index.md lists
      the new guide 3) mkdocs build succeeds 4) Guide appears in rendered docs

      REFS: Existing guide structure in mkdocs.yml

      LOCKS: mkdocs.yml, docs/guides/index.md'
    acceptance_criteria: []
    depends_on:
    - TASK-008
    labels:
    - docs
    locks: []
    priority: 2
    status: done
    created_at: '2026-01-01T08:50:15.492553+00:00'
    updated_at: '2026-01-01T09:40:29.687972+00:00'
    completed_by: ABF1D05AD
    completed_at: 2026-01-01 09:40:29.687997+00:00
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#implementation-order'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TASK-010:
    title: Add lodestar task validate command (deferred)
    description: 'WHAT: Create lodestar task validate command for CI integration.

      WHERE: src/lodestar/cli/commands/task.py (new validate_command)

      WHY: Validate task quality: PRD refs exist, acceptance criteria present, scope
      estimates (see PRD #non-goals deferral)

      SCOPE: Check all tasks for: 1) PRD reference if PRD exists 2) Non-empty acceptance_criteria
      3) Description follows format 4) Warn on issues

      ACCEPT: 1) Command exists 2) Checks for PRD refs 3) Checks for acceptance criteria
      4) Returns exit code 1 on failures 5) --json output works

      REFS: Related to --validate-prd but for all tasks post-hoc

      LOCKS: src/lodestar/cli/commands/task.py'
    acceptance_criteria: []
    depends_on:
    - TASK-004
    labels:
    - feature
    locks: []
    priority: 3
    status: ready
    created_at: '2026-01-01T08:50:24.758022+00:00'
    updated_at: '2026-01-01T08:50:24.758026+00:00'
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#non-goals'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TEST-LOCK:
    title: Test lock option
    description: ''
    acceptance_criteria: []
    depends_on: []
    labels: []
    locks:
    - src/test/**
    - tests/unit/**
    priority: 100
    status: deleted
    created_at: '2026-01-01T08:58:14.725974+00:00'
    updated_at: '2026-01-01T08:58:19.028733+00:00'
  TEST-ACCEPT:
    title: Test accept option
    description: ''
    acceptance_criteria:
    - Tests pass
    - No regressions
    - Lint clean
    depends_on: []
    labels: []
    locks: []
    priority: 100
    status: deleted
    created_at: '2026-01-01T08:59:34.138834+00:00'
    updated_at: '2026-01-01T08:59:39.505050+00:00'
  TEST-VAL-3:
    title: Test valid anchor
    description: ''
    acceptance_criteria: []
    depends_on: []
    labels: []
    locks: []
    priority: 100
    status: deleted
    created_at: '2026-01-01T09:04:07.742699+00:00'
    updated_at: '2026-01-01T09:04:19.271100+00:00'
    prd:
      source: docs/prd/task-creation-guidance.md
      refs:
      - anchor: '#cli-options'
        lines: null
      excerpt: null
      prd_hash: 3788e3b88586fa3016513b2bf439dd560218967de39b43494c5817a774667a4e
  TEST-VAL-4:
    title: Test skip validation
    description: ''
    acceptance_criteria: []
    depends_on: []
    labels: []
    locks: []
    priority: 100
    status: deleted
    created_at: '2026-01-01T09:04:13.656067+00:00'
    updated_at: '2026-01-01T09:04:20.696968+00:00'
    prd:
      source: nonexistent.md
      refs: []
      excerpt: null
      prd_hash: null
features:
  m0-skeleton:
  - F001
  - F002
  - F003
  - F004
  - F005
  - F006
  - F007
  - F008
  m1-agent-identity:
  - F009
  - F010
  - F011
  - F012
  m2-tasks:
  - F013
  - F014
  - F015
  - F016
  - F017
  - F018
  - F019
  - F020
  - F021
  - F031
  m3-leases:
  - F022
  - F023
  - F024
  - F025
  - F026
  m4-messaging:
  - F027
  - F028
  - F029
  m5-mcp:
  - F030
  m6-docs:
  - D001
  - D002
  - D003
  - D004
  - D005
  - D006
